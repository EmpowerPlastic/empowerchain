{
  "version": 3,
  "sources": ["../../node_modules/map-obj/index.js", "../../node_modules/camelcase/index.js", "../../node_modules/quick-lru/index.js", "../../node_modules/camelcase-keys/index.js", "../../node_modules/@logto/js/lib/core/fetch-token.js", "../../node_modules/@logto/js/lib/consts/openid.js", "../../node_modules/@logto/js/lib/consts/index.js", "../../node_modules/@logto/js/lib/core/oidc-config.js", "../../node_modules/@logto/js/lib/core/revoke.js", "../../node_modules/@silverhand/essentials/lib/utilities/array.js", "../../node_modules/@silverhand/essentials/lib/utilities/assertions.js", "../../node_modules/@silverhand/essentials/lib/utilities/conditional.js", "../../node_modules/@silverhand/essentials/lib/utilities/function.js", "../../node_modules/@silverhand/essentials/lib/utilities/string.js", "../../node_modules/@silverhand/essentials/lib/utilities/object.js", "../../node_modules/jose/dist/browser/runtime/webcrypto.js", "../../node_modules/jose/dist/browser/lib/buffer_utils.js", "../../node_modules/jose/dist/browser/runtime/base64url.js", "../../node_modules/jose/dist/browser/util/errors.js", "../../node_modules/jose/dist/browser/runtime/random.js", "../../node_modules/jose/dist/browser/lib/crypto_key.js", "../../node_modules/jose/dist/browser/lib/invalid_key_input.js", "../../node_modules/jose/dist/browser/runtime/is_key_like.js", "../../node_modules/jose/dist/browser/lib/is_disjoint.js", "../../node_modules/jose/dist/browser/lib/is_object.js", "../../node_modules/jose/dist/browser/runtime/check_key_length.js", "../../node_modules/jose/dist/browser/runtime/jwk_to_key.js", "../../node_modules/jose/dist/browser/key/import.js", "../../node_modules/jose/dist/browser/lib/check_key_type.js", "../../node_modules/jose/dist/browser/lib/validate_crit.js", "../../node_modules/jose/dist/browser/lib/validate_algorithms.js", "../../node_modules/jose/dist/browser/jwe/flattened/encrypt.js", "../../node_modules/jose/dist/browser/runtime/subtle_dsa.js", "../../node_modules/jose/dist/browser/runtime/get_sign_verify_key.js", "../../node_modules/jose/dist/browser/runtime/verify.js", "../../node_modules/jose/dist/browser/jws/flattened/verify.js", "../../node_modules/jose/dist/browser/jws/compact/verify.js", "../../node_modules/jose/dist/browser/lib/epoch.js", "../../node_modules/jose/dist/browser/lib/secs.js", "../../node_modules/jose/dist/browser/lib/jwt_claims_set.js", "../../node_modules/jose/dist/browser/jwt/verify.js", "../../node_modules/jose/dist/browser/jwks/local.js", "../../node_modules/jose/dist/browser/runtime/fetch_jwks.js", "../../node_modules/jose/dist/browser/jwks/remote.js", "../../node_modules/jose/dist/browser/util/base64url.js", "../../node_modules/@logto/js/lib/utils/scopes.js", "../../node_modules/@logto/js/lib/core/sign-in.js", "../../node_modules/@logto/js/lib/core/sign-out.js", "../../node_modules/@logto/js/lib/core/user-info.js", "../../node_modules/@logto/js/lib/utils/arbitrary-object.js", "../../node_modules/@logto/js/lib/utils/errors.js", "../../node_modules/@logto/js/lib/utils/callback-uri.js", "../../node_modules/@logto/js/lib/utils/id-token.js", "../../node_modules/@logto/js/lib/utils/access-token.js", "../../node_modules/@logto/client/lib/adapter/types.js", "../../node_modules/@logto/client/lib/adapter/index.js", "../../node_modules/@logto/client/lib/errors.js", "../../node_modules/@logto/client/lib/remote-jwk-set.js", "../../node_modules/@logto/client/lib/types/index.js", "../../node_modules/@logto/client/lib/utils/index.js", "../../node_modules/@logto/client/lib/utils/memoize.js", "../../node_modules/@logto/client/lib/utils/once.js", "../../node_modules/@logto/client/lib/utils/requester.js", "../../node_modules/@logto/client/lib/index.js", "../../node_modules/@logto/browser/lib/cache.js", "../../node_modules/@logto/browser/lib/storage.js", "../../node_modules/js-base64/base64.mjs", "../../node_modules/@logto/browser/lib/utils/generators.js", "../../node_modules/@logto/browser/lib/index.js", "../../node_modules/@logto/vue/lib/consts.js", "../../node_modules/@logto/vue/lib/context.js", "../../node_modules/@logto/vue/lib/plugin.js", "../../node_modules/@logto/vue/lib/index.js"],
  "sourcesContent": ["'use strict';\n\nconst isObject = value => typeof value === 'object' && value !== null;\nconst mapObjectSkip = Symbol('skip');\n\n// Customized for this use-case\nconst isObjectCustom = value =>\n\tisObject(value) &&\n\t!(value instanceof RegExp) &&\n\t!(value instanceof Error) &&\n\t!(value instanceof Date);\n\nconst mapObject = (object, mapper, options, isSeen = new WeakMap()) => {\n\toptions = {\n\t\tdeep: false,\n\t\ttarget: {},\n\t\t...options\n\t};\n\n\tif (isSeen.has(object)) {\n\t\treturn isSeen.get(object);\n\t}\n\n\tisSeen.set(object, options.target);\n\n\tconst {target} = options;\n\tdelete options.target;\n\n\tconst mapArray = array => array.map(element => isObjectCustom(element) ? mapObject(element, mapper, options, isSeen) : element);\n\tif (Array.isArray(object)) {\n\t\treturn mapArray(object);\n\t}\n\n\tfor (const [key, value] of Object.entries(object)) {\n\t\tconst mapResult = mapper(key, value, object);\n\n\t\tif (mapResult === mapObjectSkip) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tlet [newKey, newValue, {shouldRecurse = true} = {}] = mapResult;\n\n\t\t// Drop `__proto__` keys.\n\t\tif (newKey === '__proto__') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (options.deep && shouldRecurse && isObjectCustom(newValue)) {\n\t\t\tnewValue = Array.isArray(newValue) ?\n\t\t\t\tmapArray(newValue) :\n\t\t\t\tmapObject(newValue, mapper, options, isSeen);\n\t\t}\n\n\t\ttarget[newKey] = newValue;\n\t}\n\n\treturn target;\n};\n\nmodule.exports = (object, mapper, options) => {\n\tif (!isObject(object)) {\n\t\tthrow new TypeError(`Expected an object, got \\`${object}\\` (${typeof object})`);\n\t}\n\n\treturn mapObject(object, mapper, options);\n};\n\nmodule.exports.mapObjectSkip = mapObjectSkip;\n", "'use strict';\n\nconst UPPERCASE = /[\\p{Lu}]/u;\nconst LOWERCASE = /[\\p{Ll}]/u;\nconst LEADING_CAPITAL = /^[\\p{Lu}](?![\\p{Lu}])/gu;\nconst IDENTIFIER = /([\\p{Alpha}\\p{N}_]|$)/u;\nconst SEPARATORS = /[_.\\- ]+/;\n\nconst LEADING_SEPARATORS = new RegExp('^' + SEPARATORS.source);\nconst SEPARATORS_AND_IDENTIFIER = new RegExp(SEPARATORS.source + IDENTIFIER.source, 'gu');\nconst NUMBERS_AND_IDENTIFIER = new RegExp('\\\\d+' + IDENTIFIER.source, 'gu');\n\nconst preserveCamelCase = (string, toLowerCase, toUpperCase) => {\n\tlet isLastCharLower = false;\n\tlet isLastCharUpper = false;\n\tlet isLastLastCharUpper = false;\n\n\tfor (let i = 0; i < string.length; i++) {\n\t\tconst character = string[i];\n\n\t\tif (isLastCharLower && UPPERCASE.test(character)) {\n\t\t\tstring = string.slice(0, i) + '-' + string.slice(i);\n\t\t\tisLastCharLower = false;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = true;\n\t\t\ti++;\n\t\t} else if (isLastCharUpper && isLastLastCharUpper && LOWERCASE.test(character)) {\n\t\t\tstring = string.slice(0, i - 1) + '-' + string.slice(i - 1);\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = false;\n\t\t\tisLastCharLower = true;\n\t\t} else {\n\t\t\tisLastCharLower = toLowerCase(character) === character && toUpperCase(character) !== character;\n\t\t\tisLastLastCharUpper = isLastCharUpper;\n\t\t\tisLastCharUpper = toUpperCase(character) === character && toLowerCase(character) !== character;\n\t\t}\n\t}\n\n\treturn string;\n};\n\nconst preserveConsecutiveUppercase = (input, toLowerCase) => {\n\tLEADING_CAPITAL.lastIndex = 0;\n\n\treturn input.replace(LEADING_CAPITAL, m1 => toLowerCase(m1));\n};\n\nconst postProcess = (input, toUpperCase) => {\n\tSEPARATORS_AND_IDENTIFIER.lastIndex = 0;\n\tNUMBERS_AND_IDENTIFIER.lastIndex = 0;\n\n\treturn input.replace(SEPARATORS_AND_IDENTIFIER, (_, identifier) => toUpperCase(identifier))\n\t\t.replace(NUMBERS_AND_IDENTIFIER, m => toUpperCase(m));\n};\n\nconst camelCase = (input, options) => {\n\tif (!(typeof input === 'string' || Array.isArray(input))) {\n\t\tthrow new TypeError('Expected the input to be `string | string[]`');\n\t}\n\n\toptions = {\n\t\tpascalCase: false,\n\t\tpreserveConsecutiveUppercase: false,\n\t\t...options\n\t};\n\n\tif (Array.isArray(input)) {\n\t\tinput = input.map(x => x.trim())\n\t\t\t.filter(x => x.length)\n\t\t\t.join('-');\n\t} else {\n\t\tinput = input.trim();\n\t}\n\n\tif (input.length === 0) {\n\t\treturn '';\n\t}\n\n\tconst toLowerCase = options.locale === false ?\n\t\tstring => string.toLowerCase() :\n\t\tstring => string.toLocaleLowerCase(options.locale);\n\tconst toUpperCase = options.locale === false ?\n\t\tstring => string.toUpperCase() :\n\t\tstring => string.toLocaleUpperCase(options.locale);\n\n\tif (input.length === 1) {\n\t\treturn options.pascalCase ? toUpperCase(input) : toLowerCase(input);\n\t}\n\n\tconst hasUpperCase = input !== toLowerCase(input);\n\n\tif (hasUpperCase) {\n\t\tinput = preserveCamelCase(input, toLowerCase, toUpperCase);\n\t}\n\n\tinput = input.replace(LEADING_SEPARATORS, '');\n\n\tif (options.preserveConsecutiveUppercase) {\n\t\tinput = preserveConsecutiveUppercase(input, toLowerCase);\n\t} else {\n\t\tinput = toLowerCase(input);\n\t}\n\n\tif (options.pascalCase) {\n\t\tinput = toUpperCase(input.charAt(0)) + input.slice(1);\n\t}\n\n\treturn postProcess(input, toUpperCase);\n};\n\nmodule.exports = camelCase;\n// TODO: Remove this for the next major release\nmodule.exports.default = camelCase;\n", "'use strict';\n\nclass QuickLRU {\n\tconstructor(options = {}) {\n\t\tif (!(options.maxSize && options.maxSize > 0)) {\n\t\t\tthrow new TypeError('`maxSize` must be a number greater than 0');\n\t\t}\n\n\t\tthis.maxSize = options.maxSize;\n\t\tthis.onEviction = options.onEviction;\n\t\tthis.cache = new Map();\n\t\tthis.oldCache = new Map();\n\t\tthis._size = 0;\n\t}\n\n\t_set(key, value) {\n\t\tthis.cache.set(key, value);\n\t\tthis._size++;\n\n\t\tif (this._size >= this.maxSize) {\n\t\t\tthis._size = 0;\n\n\t\t\tif (typeof this.onEviction === 'function') {\n\t\t\t\tfor (const [key, value] of this.oldCache.entries()) {\n\t\t\t\t\tthis.onEviction(key, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.oldCache = this.cache;\n\t\t\tthis.cache = new Map();\n\t\t}\n\t}\n\n\tget(key) {\n\t\tif (this.cache.has(key)) {\n\t\t\treturn this.cache.get(key);\n\t\t}\n\n\t\tif (this.oldCache.has(key)) {\n\t\t\tconst value = this.oldCache.get(key);\n\t\t\tthis.oldCache.delete(key);\n\t\t\tthis._set(key, value);\n\t\t\treturn value;\n\t\t}\n\t}\n\n\tset(key, value) {\n\t\tif (this.cache.has(key)) {\n\t\t\tthis.cache.set(key, value);\n\t\t} else {\n\t\t\tthis._set(key, value);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\thas(key) {\n\t\treturn this.cache.has(key) || this.oldCache.has(key);\n\t}\n\n\tpeek(key) {\n\t\tif (this.cache.has(key)) {\n\t\t\treturn this.cache.get(key);\n\t\t}\n\n\t\tif (this.oldCache.has(key)) {\n\t\t\treturn this.oldCache.get(key);\n\t\t}\n\t}\n\n\tdelete(key) {\n\t\tconst deleted = this.cache.delete(key);\n\t\tif (deleted) {\n\t\t\tthis._size--;\n\t\t}\n\n\t\treturn this.oldCache.delete(key) || deleted;\n\t}\n\n\tclear() {\n\t\tthis.cache.clear();\n\t\tthis.oldCache.clear();\n\t\tthis._size = 0;\n\t}\n\n\t* keys() {\n\t\tfor (const [key] of this) {\n\t\t\tyield key;\n\t\t}\n\t}\n\n\t* values() {\n\t\tfor (const [, value] of this) {\n\t\t\tyield value;\n\t\t}\n\t}\n\n\t* [Symbol.iterator]() {\n\t\tfor (const item of this.cache) {\n\t\t\tyield item;\n\t\t}\n\n\t\tfor (const item of this.oldCache) {\n\t\t\tconst [key] = item;\n\t\t\tif (!this.cache.has(key)) {\n\t\t\t\tyield item;\n\t\t\t}\n\t\t}\n\t}\n\n\tget size() {\n\t\tlet oldCacheSize = 0;\n\t\tfor (const key of this.oldCache.keys()) {\n\t\t\tif (!this.cache.has(key)) {\n\t\t\t\toldCacheSize++;\n\t\t\t}\n\t\t}\n\n\t\treturn Math.min(this._size + oldCacheSize, this.maxSize);\n\t}\n}\n\nmodule.exports = QuickLRU;\n", "'use strict';\nconst mapObj = require('map-obj');\nconst camelCase = require('camelcase');\nconst QuickLru = require('quick-lru');\n\nconst has = (array, key) => array.some(x => {\n\tif (typeof x === 'string') {\n\t\treturn x === key;\n\t}\n\n\tx.lastIndex = 0;\n\treturn x.test(key);\n});\n\nconst cache = new QuickLru({maxSize: 100000});\n\n// Reproduces behavior from `map-obj`\nconst isObject = value =>\n\ttypeof value === 'object' &&\n\tvalue !== null &&\n\t!(value instanceof RegExp) &&\n\t!(value instanceof Error) &&\n\t!(value instanceof Date);\n\nconst camelCaseConvert = (input, options) => {\n\tif (!isObject(input)) {\n\t\treturn input;\n\t}\n\n\toptions = {\n\t\tdeep: false,\n\t\tpascalCase: false,\n\t\t...options\n\t};\n\n\tconst {exclude, pascalCase, stopPaths, deep} = options;\n\n\tconst stopPathsSet = new Set(stopPaths);\n\n\tconst makeMapper = parentPath => (key, value) => {\n\t\tif (deep && isObject(value)) {\n\t\t\tconst path = parentPath === undefined ? key : `${parentPath}.${key}`;\n\n\t\t\tif (!stopPathsSet.has(path)) {\n\t\t\t\tvalue = mapObj(value, makeMapper(path));\n\t\t\t}\n\t\t}\n\n\t\tif (!(exclude && has(exclude, key))) {\n\t\t\tconst cacheKey = pascalCase ? `${key}_` : key;\n\n\t\t\tif (cache.has(cacheKey)) {\n\t\t\t\tkey = cache.get(cacheKey);\n\t\t\t} else {\n\t\t\t\tconst returnValue = camelCase(key, {pascalCase, locale: false});\n\n\t\t\t\tif (key.length < 100) { // Prevent abuse\n\t\t\t\t\tcache.set(cacheKey, returnValue);\n\t\t\t\t}\n\n\t\t\t\tkey = returnValue;\n\t\t\t}\n\t\t}\n\n\t\treturn [key, value];\n\t};\n\n\treturn mapObj(input, makeMapper(undefined));\n};\n\nmodule.exports = (input, options) => {\n\tif (Array.isArray(input)) {\n\t\treturn Object.keys(input).map(key => camelCaseConvert(input[key], options));\n\t}\n\n\treturn camelCaseConvert(input, options);\n};\n", "import camelcaseKeys from 'camelcase-keys';\nimport { QueryKey, TokenGrantType, ContentType } from '../consts/index.js';\n\nconst fetchTokenByAuthorizationCode = async ({ clientId, tokenEndpoint, redirectUri, codeVerifier, code, resource, }, requester) => {\n    const parameters = new URLSearchParams();\n    parameters.append(QueryKey.ClientId, clientId);\n    parameters.append(QueryKey.Code, code);\n    parameters.append(QueryKey.CodeVerifier, codeVerifier);\n    parameters.append(QueryKey.RedirectUri, redirectUri);\n    parameters.append(QueryKey.GrantType, TokenGrantType.AuthorizationCode);\n    if (resource) {\n        parameters.append(QueryKey.Resource, resource);\n    }\n    const snakeCaseCodeTokenResponse = await requester(tokenEndpoint, {\n        method: 'POST',\n        headers: ContentType.formUrlEncoded,\n        body: parameters,\n    });\n    return camelcaseKeys(snakeCaseCodeTokenResponse);\n};\n/**\n * Fetch access token by refresh token using the token endpoint and `refresh_token` grant type.\n * @param params The parameters for fetching access token.\n * @param requester The requester for sending HTTP request.\n * @returns A Promise that resolves to the access token response.\n */\nconst fetchTokenByRefreshToken = async (params, requester) => {\n    const { clientId, tokenEndpoint, refreshToken, resource, organizationId, scopes } = params;\n    const parameters = new URLSearchParams();\n    parameters.append(QueryKey.ClientId, clientId);\n    parameters.append(QueryKey.RefreshToken, refreshToken);\n    parameters.append(QueryKey.GrantType, TokenGrantType.RefreshToken);\n    if (resource) {\n        parameters.append(QueryKey.Resource, resource);\n    }\n    if (organizationId) {\n        parameters.append(QueryKey.OrganizationId, organizationId);\n    }\n    if (scopes?.length) {\n        parameters.append(QueryKey.Scope, scopes.join(' '));\n    }\n    const snakeCaseRefreshTokenTokenResponse = await requester(tokenEndpoint, {\n        method: 'POST',\n        headers: ContentType.formUrlEncoded,\n        body: parameters,\n    });\n    return camelcaseKeys(snakeCaseRefreshTokenTokenResponse);\n};\n\nexport { fetchTokenByAuthorizationCode, fetchTokenByRefreshToken };\n", "/**\n * @overview Constants for Logto. Synchronized with `@logto/core-kit` package at hash `081094d`.\n */\n/** Scopes that reserved by Logto, which will be added to the auth request automatically. */\nvar ReservedScope;\n(function (ReservedScope) {\n    ReservedScope[\"OpenId\"] = \"openid\";\n    ReservedScope[\"OfflineAccess\"] = \"offline_access\";\n})(ReservedScope || (ReservedScope = {}));\n/** Resources that reserved by Logto, which cannot be defined by users. */\nvar ReservedResource;\n(function (ReservedResource) {\n    /**\n     * The resource for organization template per RFC 0001.\n     *\n     * @see {@link https://github.com/logto-io/rfcs | RFC 0001} for more details.\n     */\n    ReservedResource[\"Organization\"] = \"urn:logto:resource:organizations\";\n})(ReservedResource || (ReservedResource = {}));\n/**\n * Scopes for ID Token and Userinfo Endpoint.\n */\nvar UserScope;\n(function (UserScope) {\n    /**\n     * Scope for basic user info.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Profile\"] = \"profile\";\n    /**\n     * Scope for user email address.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Email\"] = \"email\";\n    /**\n     * Scope for user phone number.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Phone\"] = \"phone\";\n    /**\n     * Scope for user's custom data.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"CustomData\"] = \"custom_data\";\n    /**\n     * Scope for user's social identity details.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Identities\"] = \"identities\";\n    /**\n     * Scope for user's roles.\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Roles\"] = \"roles\";\n    /**\n     * Scope for user's organization IDs and perform organization token grant per [RFC 0001](https://github.com/logto-io/rfcs).\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"Organizations\"] = \"urn:logto:scope:organizations\";\n    /**\n     * Scope for user's organization roles per [RFC 0001](https://github.com/logto-io/rfcs).\n     *\n     * See {@link idTokenClaims} for mapped claims in ID Token and {@link userinfoClaims} for additional claims in Userinfo Endpoint.\n     */\n    UserScope[\"OrganizationRoles\"] = \"urn:logto:scope:organization_roles\";\n})(UserScope || (UserScope = {}));\n/**\n * Mapped claims that ID Token includes.\n */\nconst idTokenClaims = Object.freeze({\n    [UserScope.Profile]: ['name', 'picture', 'username'],\n    [UserScope.Email]: ['email', 'email_verified'],\n    [UserScope.Phone]: ['phone_number', 'phone_number_verified'],\n    [UserScope.Roles]: ['roles'],\n    [UserScope.Organizations]: ['organizations'],\n    [UserScope.OrganizationRoles]: ['organization_roles'],\n    [UserScope.CustomData]: [],\n    [UserScope.Identities]: [],\n});\n/**\n * Additional claims that Userinfo Endpoint returns.\n */\nconst userinfoClaims = Object.freeze({\n    [UserScope.Profile]: [],\n    [UserScope.Email]: [],\n    [UserScope.Phone]: [],\n    [UserScope.Roles]: [],\n    [UserScope.Organizations]: [],\n    [UserScope.OrganizationRoles]: [],\n    [UserScope.CustomData]: ['custom_data'],\n    [UserScope.Identities]: ['identities'],\n});\nconst userClaims = Object.freeze(\n// Hard to infer type directly, use `as` for a workaround.\n// eslint-disable-next-line no-restricted-syntax\nObject.fromEntries(Object.values(UserScope).map((current) => [\n    current,\n    [...idTokenClaims[current], ...userinfoClaims[current]],\n])));\n/**\n * The prefix of the URN (Uniform Resource Name) for the organization in Logto.\n *\n * @example\n * ```\n * urn:logto:organization:123 // organization with ID 123\n * ```\n * @see {@link https://en.wikipedia.org/wiki/Uniform_Resource_Name | Uniform Resource Name}\n */\nconst organizationUrnPrefix = 'urn:logto:organization:';\n/**\n * Build the URN (Uniform Resource Name) for the organization in Logto.\n *\n * @param organizationId The ID of the organization.\n * @returns The URN for the organization.\n * @see {@link organizationUrnPrefix} for the prefix of the URN.\n * @example\n * ```ts\n * buildOrganizationUrn('1') // returns 'urn:logto:organization:1'\n * ```\n */\nconst buildOrganizationUrn = (organizationId) => `${organizationUrnPrefix}${organizationId}`;\n/**\n * Get the organization ID from the URN (Uniform Resource Name) for the organization in Logto.\n *\n * @param urn The URN for the organization. Must start with {@link organizationUrnPrefix}.\n * @returns The ID of the organization.\n * @throws {TypeError} If the URN is invalid.\n * @example\n * ```ts\n * getOrganizationIdFromUrn('1') // throws TypeError\n * getOrganizationIdFromUrn('urn:logto:organization:1') // returns '1'\n * ```\n */\nconst getOrganizationIdFromUrn = (urn) => {\n    if (!urn.startsWith(organizationUrnPrefix)) {\n        throw new TypeError('Invalid organization URN.');\n    }\n    return urn.slice(organizationUrnPrefix.length);\n};\n\nexport { ReservedResource, ReservedScope, UserScope, buildOrganizationUrn, getOrganizationIdFromUrn, idTokenClaims, organizationUrnPrefix, userClaims, userinfoClaims };\n", "export { ReservedResource, ReservedScope, UserScope, buildOrganizationUrn, getOrganizationIdFromUrn, idTokenClaims, organizationUrnPrefix, userClaims, userinfoClaims } from './openid.js';\n\nconst ContentType = {\n    formUrlEncoded: { 'Content-Type': 'application/x-www-form-urlencoded' },\n};\nvar TokenGrantType;\n(function (TokenGrantType) {\n    TokenGrantType[\"AuthorizationCode\"] = \"authorization_code\";\n    TokenGrantType[\"RefreshToken\"] = \"refresh_token\";\n})(TokenGrantType || (TokenGrantType = {}));\nvar QueryKey;\n(function (QueryKey) {\n    QueryKey[\"ClientId\"] = \"client_id\";\n    QueryKey[\"Code\"] = \"code\";\n    QueryKey[\"CodeChallenge\"] = \"code_challenge\";\n    QueryKey[\"CodeChallengeMethod\"] = \"code_challenge_method\";\n    QueryKey[\"CodeVerifier\"] = \"code_verifier\";\n    QueryKey[\"Error\"] = \"error\";\n    QueryKey[\"ErrorDescription\"] = \"error_description\";\n    QueryKey[\"GrantType\"] = \"grant_type\";\n    QueryKey[\"IdToken\"] = \"id_token\";\n    QueryKey[\"IdTokenHint\"] = \"id_token_hint\";\n    QueryKey[\"PostLogoutRedirectUri\"] = \"post_logout_redirect_uri\";\n    QueryKey[\"Prompt\"] = \"prompt\";\n    QueryKey[\"RedirectUri\"] = \"redirect_uri\";\n    QueryKey[\"RefreshToken\"] = \"refresh_token\";\n    QueryKey[\"Resource\"] = \"resource\";\n    QueryKey[\"ResponseType\"] = \"response_type\";\n    QueryKey[\"Scope\"] = \"scope\";\n    QueryKey[\"State\"] = \"state\";\n    QueryKey[\"Token\"] = \"token\";\n    // Need to align with the OIDC extraParams settings in core\n    QueryKey[\"InteractionMode\"] = \"interaction_mode\";\n    /** The query key for specifying the organization ID. */\n    QueryKey[\"OrganizationId\"] = \"organization_id\";\n})(QueryKey || (QueryKey = {}));\n/** The prompt parameter to be used for the authorization request. */\nvar Prompt;\n(function (Prompt) {\n    /**\n     * The Authorization Server MUST prompt the End-User for consent\n     * before returning information to the Client.\n     */\n    Prompt[\"Consent\"] = \"consent\";\n    /**\n     * The Authorization Server MUST prompt the End-User for re-authentication,\n     * forcing the user to log in again. Note the there'll be no Refresh Token\n     * returned in this case.\n     */\n    Prompt[\"Login\"] = \"login\";\n})(Prompt || (Prompt = {}));\n\nexport { ContentType, Prompt, QueryKey, TokenGrantType };\n", "import camelcaseKeys from 'camelcase-keys';\n\nconst discoveryPath = '/oidc/.well-known/openid-configuration';\nconst fetchOidcConfig = async (endpoint, requester) => camelcaseKeys(await requester(endpoint));\n\nexport { discoveryPath, fetchOidcConfig };\n", "import { ContentType, QueryKey } from '../consts/index.js';\n\nconst revoke = async (revocationEndpoint, clientId, token, requester) => requester(revocationEndpoint, {\n    method: 'POST',\n    headers: ContentType.formUrlEncoded,\n    body: new URLSearchParams({\n        [QueryKey.ClientId]: clientId,\n        [QueryKey.Token]: token,\n    }),\n});\n\nexport { revoke };\n", "const normalizeValueToStringArray = (value) => {\n    if (value) {\n        return Array.isArray(value) ? value : [value];\n    }\n    return [];\n};\n// Disable FP rules here to use the performant approach while keep the function itself \"FP\"\n/* eslint-disable @silverhand/fp/no-let, @silverhand/fp/no-mutation */\nconst repeat = (times, initial, iterate) => {\n    let result = initial;\n    while (times--) {\n        result = iterate(result);\n    }\n    return result;\n};\n/* eslint-enable @silverhand/fp/no-let, @silverhand/fp/no-mutation */\nconst deduplicate = (array) => [...new Set(array)];\n\nexport { deduplicate, normalizeValueToStringArray, repeat };\n", "// eslint-disable-next-line id-length\nconst compareFunction = (a, b) => {\n    if (typeof a === 'string' && typeof b === 'string') {\n        return a.localeCompare(b);\n    }\n    if (typeof a === 'number' && typeof b === 'number') {\n        return a - b;\n    }\n    if (typeof a === 'boolean' && typeof b === 'boolean') {\n        return Number(a) - Number(b);\n    }\n    throw new Error('Unsupported compare type');\n};\nconst isSameArray = (array1, array2) => {\n    if (array1.length !== array2.length) {\n        return false;\n    }\n    const sortedA = array1.slice().sort(compareFunction);\n    const sortedB = array2.slice().sort(compareFunction);\n    return sortedA.every((value, index) => value === sortedB[index]);\n};\n// eslint-disable-next-line unicorn/prefer-native-coercion-functions\nconst notFalsy = (value) => Boolean(value);\nconst notEmpty = (value) => value !== null && value !== undefined;\nconst has = (data, property) => Object.prototype.hasOwnProperty.call(data, property);\nconst hasChineseCharacter = (string) => Boolean(/[\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF]/.test(string));\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types -- this is a utility function\nconst isObject = (object) => Object.prototype.toString.call(object) === '[object Object]';\n/** Returns true if an object was created by the `Object` constructor, or `Object.create(null)`. */\nfunction isPlainObject(object) {\n    if (!isObject(object)) {\n        return false;\n    }\n    // If has modified constructor\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (object.constructor === undefined) {\n        return true;\n    }\n    // If has modified prototype\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, prefer-destructuring\n    const prototype = object.constructor.prototype;\n    if (!isObject(prototype)) {\n        return false;\n    }\n    // If constructor does not have an Object-specific method\n    if (!has(prototype, 'isPrototypeOf')) {\n        return false;\n    }\n    // Most likely a plain Object\n    return true;\n}\n\nexport { has, hasChineseCharacter, isPlainObject, isSameArray, notEmpty, notFalsy };\n", "import { notFalsy } from './assertions.js';\n\nconst nullable = (exp) => (notFalsy(exp) ? exp : null);\n/**\n * Conditional return the expression result when it's not {@link Falsy};\n * otherwise return `undefined`.\n *\n * @example\n * ```ts\n * conditional(1 && '2') // '2'\n * conditional(false && '1') // undefined\n * ```\n */\nconst conditional = (exp) => (notFalsy(exp) ? exp : undefined);\n/** Alias for {@link conditional}. */\nconst cond = conditional;\n/**\n * Conditional return the stringified expression result (using `String`) when it's not {@link Falsy};\n * otherwise return an empty string.\n *\n * @example\n * ```ts\n * conditionalString(1 && 2) // '2'\n * conditionalString(false && '1') // ''\n * ```\n */\nconst conditionalString = (exp) => (notFalsy(exp) ? String(exp) : '');\n/** Alias for {@link conditionalString}. */\nconst condString = conditionalString;\n/**\n * Conditional concat multiple expression results into a array by filtering all {@link Falsy} results\n * and flatten 1 level deep if the expression result is an array.\n *\n * @example\n * ```ts\n * conditionalArray(1, [2, 3]) // [1, 2, 3]\n * ```\n */\nconst conditionalArray = (...exps) => exps.filter((value) => notFalsy(value)).flat();\n/** Alias for {@link conditionalArray}. */\nconst condArray = conditionalArray;\n/**\n * Return a new object with all {@link Falsy} values removed.\n * This function only performs a shallow removal, i.e. it does not remove\n * {@link Falsy} values nested in objects.\n *\n * @example\n * ```ts\n * conditionalObject({\n *   foo: 'foo',\n *   bar: undefined,\n *   baz: false,\n * }) // { foo: 'foo' }\n * ```\n */\nconst conditionalObject = (object) => \n// eslint-disable-next-line no-restricted-syntax\nObject.fromEntries(Object.entries(object).filter(([, value]) => notFalsy(value)));\n/** Alias for {@link conditionalObject}. */\nconst condObject = conditionalObject;\n\nexport { cond, condArray, condObject, condString, conditional, conditionalArray, conditionalObject, conditionalString, nullable };\n", "// Intended\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => { };\nconst isPromise = (value) => value !== null &&\n    (typeof value === 'object' || typeof value === 'function') &&\n    'then' in value &&\n    typeof value.then === 'function';\n// eslint-disable-next-line @typescript-eslint/promise-function-async\nconst tryThat = (exec, onError) => {\n    const handleError = (error) => {\n        if (onError instanceof Error) {\n            throw onError;\n        }\n        return onError(error);\n    };\n    try {\n        const unwrapped = typeof exec === 'function' ? exec() : exec;\n        // eslint-disable-next-line promise/prefer-await-to-then\n        return isPromise(unwrapped) ? unwrapped.catch(handleError) : unwrapped;\n    }\n    catch (error) {\n        return handleError(error);\n    }\n};\n// eslint-disable-next-line @typescript-eslint/promise-function-async\nconst trySafe = (exec, onError) => {\n    try {\n        const unwrapped = typeof exec === 'function' ? exec() : exec;\n        return isPromise(unwrapped)\n            ? // eslint-disable-next-line promise/prefer-await-to-then\n                unwrapped.catch((error) => {\n                    onError?.(error);\n                })\n            : unwrapped;\n    }\n    catch (error) {\n        onError?.(error);\n    }\n};\n\nexport { isPromise, noop, trySafe, tryThat };\n", "function toTitle(string) {\n    if (typeof string !== 'string') {\n        throw new TypeError('Expected a string');\n    }\n    return string\n        .toLowerCase()\n        .replaceAll(/(?:^|\\s|-)\\S/g, (value) => value.toUpperCase())\n        .replaceAll('-', ' ');\n}\n/**\n * RFC 4648 section 5: base64url (URL- and filename-safe standard)\n * @link https://datatracker.ietf.org/doc/html/rfc4648#section-5\n */\nconst replaceNonUrlSafeCharacters = (base64String) => base64String.replaceAll('+', '-').replaceAll('/', '_').replaceAll(/=+$/g, '');\nconst restoreNonUrlSafeCharacters = (base64String) => base64String.replaceAll('-', '+').replaceAll('_', '/');\nconst urlSafeBase64 = {\n    isSafe: (input) => /^[\\w-]*$/.test(input),\n    encode: (rawString) => {\n        const encodedString = btoa(unescape(encodeURIComponent(rawString)));\n        return replaceNonUrlSafeCharacters(encodedString);\n    },\n    decode: (encodedString) => {\n        const nonUrlSafeEncodedString = restoreNonUrlSafeCharacters(encodedString);\n        return decodeURIComponent(escape(atob(nonUrlSafeEncodedString)));\n    },\n    replaceNonUrlSafeCharacters,\n    restoreNonUrlSafeCharacters,\n};\nconst yes = (value) => \n// eslint-disable-next-line no-implicit-coercion\n!!value && ['1', 'true', 'y', 'yes', 'yep', 'yeah'].includes(value.toLowerCase());\n\nexport { toTitle, urlSafeBase64, yes };\n", "// eslint-disable-next-line @typescript-eslint/ban-types\nconst isObject = (object) => object !== null && typeof object === 'object';\nconst isKeyInObject = (object, key\n// eslint-disable-next-line @typescript-eslint/ban-types\n) => isObject(object) && key in object;\n/**\n * Remove all keys with `undefined` values from an object. This function only\n * performs a shallow removal, i.e. it does not remove `undefined` values nested\n * in objects.\n *\n * @param object The object to remove `undefined` keys from.\n * @returns A new object with all `undefined` keys removed.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types -- this is a utility function\nconst removeUndefinedKeys = (object) => \n// eslint-disable-next-line no-restricted-syntax\nObject.fromEntries(Object.entries(object).filter(([, value]) => value !== undefined));\n\nexport { isKeyInObject, isObject, removeUndefinedKeys };\n", "export default crypto;\nexport const isCryptoKey = (key) => key instanceof CryptoKey;\n", "import digest from '../runtime/digest.js';\nexport const encoder = new TextEncoder();\nexport const decoder = new TextDecoder();\nconst MAX_INT32 = 2 ** 32;\nexport function concat(...buffers) {\n    const size = buffers.reduce((acc, { length }) => acc + length, 0);\n    const buf = new Uint8Array(size);\n    let i = 0;\n    buffers.forEach((buffer) => {\n        buf.set(buffer, i);\n        i += buffer.length;\n    });\n    return buf;\n}\nexport function p2s(alg, p2sInput) {\n    return concat(encoder.encode(alg), new Uint8Array([0]), p2sInput);\n}\nfunction writeUInt32BE(buf, value, offset) {\n    if (value < 0 || value >= MAX_INT32) {\n        throw new RangeError(`value must be >= 0 and <= ${MAX_INT32 - 1}. Received ${value}`);\n    }\n    buf.set([value >>> 24, value >>> 16, value >>> 8, value & 0xff], offset);\n}\nexport function uint64be(value) {\n    const high = Math.floor(value / MAX_INT32);\n    const low = value % MAX_INT32;\n    const buf = new Uint8Array(8);\n    writeUInt32BE(buf, high, 0);\n    writeUInt32BE(buf, low, 4);\n    return buf;\n}\nexport function uint32be(value) {\n    const buf = new Uint8Array(4);\n    writeUInt32BE(buf, value);\n    return buf;\n}\nexport function lengthAndInput(input) {\n    return concat(uint32be(input.length), input);\n}\nexport async function concatKdf(secret, bits, value) {\n    const iterations = Math.ceil((bits >> 3) / 32);\n    const res = new Uint8Array(iterations * 32);\n    for (let iter = 0; iter < iterations; iter++) {\n        const buf = new Uint8Array(4 + secret.length + value.length);\n        buf.set(uint32be(iter + 1));\n        buf.set(secret, 4);\n        buf.set(value, 4 + secret.length);\n        res.set(await digest('sha256', buf), iter * 32);\n    }\n    return res.slice(0, bits >> 3);\n}\n", "import { encoder, decoder } from '../lib/buffer_utils.js';\nexport const encodeBase64 = (input) => {\n    let unencoded = input;\n    if (typeof unencoded === 'string') {\n        unencoded = encoder.encode(unencoded);\n    }\n    const CHUNK_SIZE = 0x8000;\n    const arr = [];\n    for (let i = 0; i < unencoded.length; i += CHUNK_SIZE) {\n        arr.push(String.fromCharCode.apply(null, unencoded.subarray(i, i + CHUNK_SIZE)));\n    }\n    return btoa(arr.join(''));\n};\nexport const encode = (input) => {\n    return encodeBase64(input).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n};\nexport const decodeBase64 = (encoded) => {\n    const binary = atob(encoded);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes;\n};\nexport const decode = (input) => {\n    let encoded = input;\n    if (encoded instanceof Uint8Array) {\n        encoded = decoder.decode(encoded);\n    }\n    encoded = encoded.replace(/-/g, '+').replace(/_/g, '/').replace(/\\s/g, '');\n    try {\n        return decodeBase64(encoded);\n    }\n    catch {\n        throw new TypeError('The input to be decoded is not correctly encoded.');\n    }\n};\n", "export class JOSEError extends Error {\n    static get code() {\n        return 'ERR_JOSE_GENERIC';\n    }\n    constructor(message) {\n        super(message);\n        this.code = 'ERR_JOSE_GENERIC';\n        this.name = this.constructor.name;\n        Error.captureStackTrace?.(this, this.constructor);\n    }\n}\nexport class JWTClaimValidationFailed extends JOSEError {\n    static get code() {\n        return 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n    }\n    constructor(message, claim = 'unspecified', reason = 'unspecified') {\n        super(message);\n        this.code = 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n        this.claim = claim;\n        this.reason = reason;\n    }\n}\nexport class JWTExpired extends JOSEError {\n    static get code() {\n        return 'ERR_JWT_EXPIRED';\n    }\n    constructor(message, claim = 'unspecified', reason = 'unspecified') {\n        super(message);\n        this.code = 'ERR_JWT_EXPIRED';\n        this.claim = claim;\n        this.reason = reason;\n    }\n}\nexport class JOSEAlgNotAllowed extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JOSE_ALG_NOT_ALLOWED';\n    }\n    static get code() {\n        return 'ERR_JOSE_ALG_NOT_ALLOWED';\n    }\n}\nexport class JOSENotSupported extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JOSE_NOT_SUPPORTED';\n    }\n    static get code() {\n        return 'ERR_JOSE_NOT_SUPPORTED';\n    }\n}\nexport class JWEDecryptionFailed extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWE_DECRYPTION_FAILED';\n        this.message = 'decryption operation failed';\n    }\n    static get code() {\n        return 'ERR_JWE_DECRYPTION_FAILED';\n    }\n}\nexport class JWEInvalid extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWE_INVALID';\n    }\n    static get code() {\n        return 'ERR_JWE_INVALID';\n    }\n}\nexport class JWSInvalid extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWS_INVALID';\n    }\n    static get code() {\n        return 'ERR_JWS_INVALID';\n    }\n}\nexport class JWTInvalid extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWT_INVALID';\n    }\n    static get code() {\n        return 'ERR_JWT_INVALID';\n    }\n}\nexport class JWKInvalid extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWK_INVALID';\n    }\n    static get code() {\n        return 'ERR_JWK_INVALID';\n    }\n}\nexport class JWKSInvalid extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWKS_INVALID';\n    }\n    static get code() {\n        return 'ERR_JWKS_INVALID';\n    }\n}\nexport class JWKSNoMatchingKey extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWKS_NO_MATCHING_KEY';\n        this.message = 'no applicable key found in the JSON Web Key Set';\n    }\n    static get code() {\n        return 'ERR_JWKS_NO_MATCHING_KEY';\n    }\n}\nexport class JWKSMultipleMatchingKeys extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n        this.message = 'multiple matching keys found in the JSON Web Key Set';\n    }\n    static get code() {\n        return 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n    }\n}\nSymbol.asyncIterator;\nexport class JWKSTimeout extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWKS_TIMEOUT';\n        this.message = 'request timed out';\n    }\n    static get code() {\n        return 'ERR_JWKS_TIMEOUT';\n    }\n}\nexport class JWSSignatureVerificationFailed extends JOSEError {\n    constructor() {\n        super(...arguments);\n        this.code = 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n        this.message = 'signature verification failed';\n    }\n    static get code() {\n        return 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n    }\n}\n", "import crypto from './webcrypto.js';\nexport default crypto.getRandomValues.bind(crypto);\n", "function unusable(name, prop = 'algorithm.name') {\n    return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`);\n}\nfunction isAlgorithm(algorithm, name) {\n    return algorithm.name === name;\n}\nfunction getHashLength(hash) {\n    return parseInt(hash.name.slice(4), 10);\n}\nfunction getNamedCurve(alg) {\n    switch (alg) {\n        case 'ES256':\n            return 'P-256';\n        case 'ES384':\n            return 'P-384';\n        case 'ES512':\n            return 'P-521';\n        default:\n            throw new Error('unreachable');\n    }\n}\nfunction checkUsage(key, usages) {\n    if (usages.length && !usages.some((expected) => key.usages.includes(expected))) {\n        let msg = 'CryptoKey does not support this operation, its usages must include ';\n        if (usages.length > 2) {\n            const last = usages.pop();\n            msg += `one of ${usages.join(', ')}, or ${last}.`;\n        }\n        else if (usages.length === 2) {\n            msg += `one of ${usages[0]} or ${usages[1]}.`;\n        }\n        else {\n            msg += `${usages[0]}.`;\n        }\n        throw new TypeError(msg);\n    }\n}\nexport function checkSigCryptoKey(key, alg, ...usages) {\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512': {\n            if (!isAlgorithm(key.algorithm, 'HMAC'))\n                throw unusable('HMAC');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'RS256':\n        case 'RS384':\n        case 'RS512': {\n            if (!isAlgorithm(key.algorithm, 'RSASSA-PKCS1-v1_5'))\n                throw unusable('RSASSA-PKCS1-v1_5');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'PS256':\n        case 'PS384':\n        case 'PS512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-PSS'))\n                throw unusable('RSA-PSS');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'EdDSA': {\n            if (key.algorithm.name !== 'Ed25519' && key.algorithm.name !== 'Ed448') {\n                throw unusable('Ed25519 or Ed448');\n            }\n            break;\n        }\n        case 'ES256':\n        case 'ES384':\n        case 'ES512': {\n            if (!isAlgorithm(key.algorithm, 'ECDSA'))\n                throw unusable('ECDSA');\n            const expected = getNamedCurve(alg);\n            const actual = key.algorithm.namedCurve;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.namedCurve');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usages);\n}\nexport function checkEncCryptoKey(key, alg, ...usages) {\n    switch (alg) {\n        case 'A128GCM':\n        case 'A192GCM':\n        case 'A256GCM': {\n            if (!isAlgorithm(key.algorithm, 'AES-GCM'))\n                throw unusable('AES-GCM');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'A128KW':\n        case 'A192KW':\n        case 'A256KW': {\n            if (!isAlgorithm(key.algorithm, 'AES-KW'))\n                throw unusable('AES-KW');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'ECDH': {\n            switch (key.algorithm.name) {\n                case 'ECDH':\n                case 'X25519':\n                case 'X448':\n                    break;\n                default:\n                    throw unusable('ECDH, X25519, or X448');\n            }\n            break;\n        }\n        case 'PBES2-HS256+A128KW':\n        case 'PBES2-HS384+A192KW':\n        case 'PBES2-HS512+A256KW':\n            if (!isAlgorithm(key.algorithm, 'PBKDF2'))\n                throw unusable('PBKDF2');\n            break;\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-OAEP'))\n                throw unusable('RSA-OAEP');\n            const expected = parseInt(alg.slice(9), 10) || 1;\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usages);\n}\n", "function message(msg, actual, ...types) {\n    if (types.length > 2) {\n        const last = types.pop();\n        msg += `one of type ${types.join(', ')}, or ${last}.`;\n    }\n    else if (types.length === 2) {\n        msg += `one of type ${types[0]} or ${types[1]}.`;\n    }\n    else {\n        msg += `of type ${types[0]}.`;\n    }\n    if (actual == null) {\n        msg += ` Received ${actual}`;\n    }\n    else if (typeof actual === 'function' && actual.name) {\n        msg += ` Received function ${actual.name}`;\n    }\n    else if (typeof actual === 'object' && actual != null) {\n        if (actual.constructor && actual.constructor.name) {\n            msg += ` Received an instance of ${actual.constructor.name}`;\n        }\n    }\n    return msg;\n}\nexport default (actual, ...types) => {\n    return message('Key must be ', actual, ...types);\n};\nexport function withAlg(alg, actual, ...types) {\n    return message(`Key for the ${alg} algorithm must be `, actual, ...types);\n}\n", "import { isCryptoKey } from './webcrypto.js';\nexport default (key) => {\n    return isCryptoKey(key);\n};\nexport const types = ['CryptoKey'];\n", "const isDisjoint = (...headers) => {\n    const sources = headers.filter(Boolean);\n    if (sources.length === 0 || sources.length === 1) {\n        return true;\n    }\n    let acc;\n    for (const header of sources) {\n        const parameters = Object.keys(header);\n        if (!acc || acc.size === 0) {\n            acc = new Set(parameters);\n            continue;\n        }\n        for (const parameter of parameters) {\n            if (acc.has(parameter)) {\n                return false;\n            }\n            acc.add(parameter);\n        }\n    }\n    return true;\n};\nexport default isDisjoint;\n", "function isObjectLike(value) {\n    return typeof value === 'object' && value !== null;\n}\nexport default function isObject(input) {\n    if (!isObjectLike(input) || Object.prototype.toString.call(input) !== '[object Object]') {\n        return false;\n    }\n    if (Object.getPrototypeOf(input) === null) {\n        return true;\n    }\n    let proto = input;\n    while (Object.getPrototypeOf(proto) !== null) {\n        proto = Object.getPrototypeOf(proto);\n    }\n    return Object.getPrototypeOf(input) === proto;\n}\n", "export default (alg, key) => {\n    if (alg.startsWith('RS') || alg.startsWith('PS')) {\n        const { modulusLength } = key.algorithm;\n        if (typeof modulusLength !== 'number' || modulusLength < 2048) {\n            throw new TypeError(`${alg} requires key modulusLength to be 2048 bits or larger`);\n        }\n    }\n};\n", "import crypto from './webcrypto.js';\nimport { JOSENotSupported } from '../util/errors.js';\nfunction subtleMapping(jwk) {\n    let algorithm;\n    let keyUsages;\n    switch (jwk.kty) {\n        case 'RSA': {\n            switch (jwk.alg) {\n                case 'PS256':\n                case 'PS384':\n                case 'PS512':\n                    algorithm = { name: 'RSA-PSS', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RS256':\n                case 'RS384':\n                case 'RS512':\n                    algorithm = { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RSA-OAEP':\n                case 'RSA-OAEP-256':\n                case 'RSA-OAEP-384':\n                case 'RSA-OAEP-512':\n                    algorithm = {\n                        name: 'RSA-OAEP',\n                        hash: `SHA-${parseInt(jwk.alg.slice(-3), 10) || 1}`,\n                    };\n                    keyUsages = jwk.d ? ['decrypt', 'unwrapKey'] : ['encrypt', 'wrapKey'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'EC': {\n            switch (jwk.alg) {\n                case 'ES256':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-256' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES384':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-384' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES512':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-521' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: 'ECDH', namedCurve: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'OKP': {\n            switch (jwk.alg) {\n                case 'EdDSA':\n                    algorithm = { name: jwk.crv };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"kty\" (Key Type) Parameter value');\n    }\n    return { algorithm, keyUsages };\n}\nconst parse = async (jwk) => {\n    if (!jwk.alg) {\n        throw new TypeError('\"alg\" argument is required when \"jwk.alg\" is not present');\n    }\n    const { algorithm, keyUsages } = subtleMapping(jwk);\n    const rest = [\n        algorithm,\n        jwk.ext ?? false,\n        jwk.key_ops ?? keyUsages,\n    ];\n    const keyData = { ...jwk };\n    delete keyData.alg;\n    delete keyData.use;\n    return crypto.subtle.importKey('jwk', keyData, ...rest);\n};\nexport default parse;\n", "import { decode as decodeBase64URL } from '../runtime/base64url.js';\nimport { fromSPKI, fromPKCS8, fromX509 } from '../runtime/asn1.js';\nimport asKeyObject from '../runtime/jwk_to_key.js';\nimport { JOSENotSupported } from '../util/errors.js';\nimport isObject from '../lib/is_object.js';\nexport async function importSPKI(spki, alg, options) {\n    if (typeof spki !== 'string' || spki.indexOf('-----BEGIN PUBLIC KEY-----') !== 0) {\n        throw new TypeError('\"spki\" must be SPKI formatted string');\n    }\n    return fromSPKI(spki, alg, options);\n}\nexport async function importX509(x509, alg, options) {\n    if (typeof x509 !== 'string' || x509.indexOf('-----BEGIN CERTIFICATE-----') !== 0) {\n        throw new TypeError('\"x509\" must be X.509 formatted string');\n    }\n    return fromX509(x509, alg, options);\n}\nexport async function importPKCS8(pkcs8, alg, options) {\n    if (typeof pkcs8 !== 'string' || pkcs8.indexOf('-----BEGIN PRIVATE KEY-----') !== 0) {\n        throw new TypeError('\"pkcs8\" must be PKCS#8 formatted string');\n    }\n    return fromPKCS8(pkcs8, alg, options);\n}\nexport async function importJWK(jwk, alg) {\n    if (!isObject(jwk)) {\n        throw new TypeError('JWK must be an object');\n    }\n    alg || (alg = jwk.alg);\n    switch (jwk.kty) {\n        case 'oct':\n            if (typeof jwk.k !== 'string' || !jwk.k) {\n                throw new TypeError('missing \"k\" (Key Value) Parameter value');\n            }\n            return decodeBase64URL(jwk.k);\n        case 'RSA':\n            if (jwk.oth !== undefined) {\n                throw new JOSENotSupported('RSA JWK \"oth\" (Other Primes Info) Parameter value is not supported');\n            }\n        case 'EC':\n        case 'OKP':\n            return asKeyObject({ ...jwk, alg });\n        default:\n            throw new JOSENotSupported('Unsupported \"kty\" (Key Type) Parameter value');\n    }\n}\n", "import { withAlg as invalidKeyInput } from './invalid_key_input.js';\nimport isKeyLike, { types } from '../runtime/is_key_like.js';\nconst symmetricTypeCheck = (alg, key) => {\n    if (key instanceof Uint8Array)\n        return;\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, ...types, 'Uint8Array'));\n    }\n    if (key.type !== 'secret') {\n        throw new TypeError(`${types.join(' or ')} instances for symmetric algorithms must be of type \"secret\"`);\n    }\n};\nconst asymmetricTypeCheck = (alg, key, usage) => {\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, ...types));\n    }\n    if (key.type === 'secret') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithms must not be of type \"secret\"`);\n    }\n    if (usage === 'sign' && key.type === 'public') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm signing must be of type \"private\"`);\n    }\n    if (usage === 'decrypt' && key.type === 'public') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm decryption must be of type \"private\"`);\n    }\n    if (key.algorithm && usage === 'verify' && key.type === 'private') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm verifying must be of type \"public\"`);\n    }\n    if (key.algorithm && usage === 'encrypt' && key.type === 'private') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm encryption must be of type \"public\"`);\n    }\n};\nconst checkKeyType = (alg, key, usage) => {\n    const symmetric = alg.startsWith('HS') ||\n        alg === 'dir' ||\n        alg.startsWith('PBES2') ||\n        /^A\\d{3}(?:GCM)?KW$/.test(alg);\n    if (symmetric) {\n        symmetricTypeCheck(alg, key);\n    }\n    else {\n        asymmetricTypeCheck(alg, key, usage);\n    }\n};\nexport default checkKeyType;\n", "import { JOSENotSupported } from '../util/errors.js';\nfunction validateCrit(Err, recognizedDefault, recognizedOption, protectedHeader, joseHeader) {\n    if (joseHeader.crit !== undefined && protectedHeader.crit === undefined) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be integrity protected');\n    }\n    if (!protectedHeader || protectedHeader.crit === undefined) {\n        return new Set();\n    }\n    if (!Array.isArray(protectedHeader.crit) ||\n        protectedHeader.crit.length === 0 ||\n        protectedHeader.crit.some((input) => typeof input !== 'string' || input.length === 0)) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be an array of non-empty strings when present');\n    }\n    let recognized;\n    if (recognizedOption !== undefined) {\n        recognized = new Map([...Object.entries(recognizedOption), ...recognizedDefault.entries()]);\n    }\n    else {\n        recognized = recognizedDefault;\n    }\n    for (const parameter of protectedHeader.crit) {\n        if (!recognized.has(parameter)) {\n            throw new JOSENotSupported(`Extension Header Parameter \"${parameter}\" is not recognized`);\n        }\n        if (joseHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" is missing`);\n        }\n        else if (recognized.get(parameter) && protectedHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" MUST be integrity protected`);\n        }\n    }\n    return new Set(protectedHeader.crit);\n}\nexport default validateCrit;\n", "const validateAlgorithms = (option, algorithms) => {\n    if (algorithms !== undefined &&\n        (!Array.isArray(algorithms) || algorithms.some((s) => typeof s !== 'string'))) {\n        throw new TypeError(`\"${option}\" option must be an array of strings`);\n    }\n    if (!algorithms) {\n        return undefined;\n    }\n    return new Set(algorithms);\n};\nexport default validateAlgorithms;\n", "import { encode as base64url } from '../../runtime/base64url.js';\nimport encrypt from '../../runtime/encrypt.js';\nimport generateIv from '../../lib/iv.js';\nimport encryptKeyManagement from '../../lib/encrypt_key_management.js';\nimport { JOSENotSupported, JWEInvalid } from '../../util/errors.js';\nimport isDisjoint from '../../lib/is_disjoint.js';\nimport { encoder, decoder, concat } from '../../lib/buffer_utils.js';\nimport validateCrit from '../../lib/validate_crit.js';\nexport const unprotected = Symbol();\nexport class FlattenedEncrypt {\n    constructor(plaintext) {\n        if (!(plaintext instanceof Uint8Array)) {\n            throw new TypeError('plaintext must be an instance of Uint8Array');\n        }\n        this._plaintext = plaintext;\n    }\n    setKeyManagementParameters(parameters) {\n        if (this._keyManagementParameters) {\n            throw new TypeError('setKeyManagementParameters can only be called once');\n        }\n        this._keyManagementParameters = parameters;\n        return this;\n    }\n    setProtectedHeader(protectedHeader) {\n        if (this._protectedHeader) {\n            throw new TypeError('setProtectedHeader can only be called once');\n        }\n        this._protectedHeader = protectedHeader;\n        return this;\n    }\n    setSharedUnprotectedHeader(sharedUnprotectedHeader) {\n        if (this._sharedUnprotectedHeader) {\n            throw new TypeError('setSharedUnprotectedHeader can only be called once');\n        }\n        this._sharedUnprotectedHeader = sharedUnprotectedHeader;\n        return this;\n    }\n    setUnprotectedHeader(unprotectedHeader) {\n        if (this._unprotectedHeader) {\n            throw new TypeError('setUnprotectedHeader can only be called once');\n        }\n        this._unprotectedHeader = unprotectedHeader;\n        return this;\n    }\n    setAdditionalAuthenticatedData(aad) {\n        this._aad = aad;\n        return this;\n    }\n    setContentEncryptionKey(cek) {\n        if (this._cek) {\n            throw new TypeError('setContentEncryptionKey can only be called once');\n        }\n        this._cek = cek;\n        return this;\n    }\n    setInitializationVector(iv) {\n        if (this._iv) {\n            throw new TypeError('setInitializationVector can only be called once');\n        }\n        this._iv = iv;\n        return this;\n    }\n    async encrypt(key, options) {\n        if (!this._protectedHeader && !this._unprotectedHeader && !this._sharedUnprotectedHeader) {\n            throw new JWEInvalid('either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()');\n        }\n        if (!isDisjoint(this._protectedHeader, this._unprotectedHeader, this._sharedUnprotectedHeader)) {\n            throw new JWEInvalid('JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint');\n        }\n        const joseHeader = {\n            ...this._protectedHeader,\n            ...this._unprotectedHeader,\n            ...this._sharedUnprotectedHeader,\n        };\n        validateCrit(JWEInvalid, new Map(), options?.crit, this._protectedHeader, joseHeader);\n        if (joseHeader.zip !== undefined) {\n            throw new JOSENotSupported('JWE \"zip\" (Compression Algorithm) Header Parameter is not supported.');\n        }\n        const { alg, enc } = joseHeader;\n        if (typeof alg !== 'string' || !alg) {\n            throw new JWEInvalid('JWE \"alg\" (Algorithm) Header Parameter missing or invalid');\n        }\n        if (typeof enc !== 'string' || !enc) {\n            throw new JWEInvalid('JWE \"enc\" (Encryption Algorithm) Header Parameter missing or invalid');\n        }\n        let encryptedKey;\n        if (alg === 'dir') {\n            if (this._cek) {\n                throw new TypeError('setContentEncryptionKey cannot be called when using Direct Encryption');\n            }\n        }\n        else if (alg === 'ECDH-ES') {\n            if (this._cek) {\n                throw new TypeError('setContentEncryptionKey cannot be called when using Direct Key Agreement');\n            }\n        }\n        let cek;\n        {\n            let parameters;\n            ({ cek, encryptedKey, parameters } = await encryptKeyManagement(alg, enc, key, this._cek, this._keyManagementParameters));\n            if (parameters) {\n                if (options && unprotected in options) {\n                    if (!this._unprotectedHeader) {\n                        this.setUnprotectedHeader(parameters);\n                    }\n                    else {\n                        this._unprotectedHeader = { ...this._unprotectedHeader, ...parameters };\n                    }\n                }\n                else {\n                    if (!this._protectedHeader) {\n                        this.setProtectedHeader(parameters);\n                    }\n                    else {\n                        this._protectedHeader = { ...this._protectedHeader, ...parameters };\n                    }\n                }\n            }\n        }\n        this._iv || (this._iv = generateIv(enc));\n        let additionalData;\n        let protectedHeader;\n        let aadMember;\n        if (this._protectedHeader) {\n            protectedHeader = encoder.encode(base64url(JSON.stringify(this._protectedHeader)));\n        }\n        else {\n            protectedHeader = encoder.encode('');\n        }\n        if (this._aad) {\n            aadMember = base64url(this._aad);\n            additionalData = concat(protectedHeader, encoder.encode('.'), encoder.encode(aadMember));\n        }\n        else {\n            additionalData = protectedHeader;\n        }\n        const { ciphertext, tag } = await encrypt(enc, this._plaintext, cek, this._iv, additionalData);\n        const jwe = {\n            ciphertext: base64url(ciphertext),\n            iv: base64url(this._iv),\n            tag: base64url(tag),\n        };\n        if (encryptedKey) {\n            jwe.encrypted_key = base64url(encryptedKey);\n        }\n        if (aadMember) {\n            jwe.aad = aadMember;\n        }\n        if (this._protectedHeader) {\n            jwe.protected = decoder.decode(protectedHeader);\n        }\n        if (this._sharedUnprotectedHeader) {\n            jwe.unprotected = this._sharedUnprotectedHeader;\n        }\n        if (this._unprotectedHeader) {\n            jwe.header = this._unprotectedHeader;\n        }\n        return jwe;\n    }\n}\n", "import { JOSENotSupported } from '../util/errors.js';\nexport default function subtleDsa(alg, algorithm) {\n    const hash = `SHA-${alg.slice(-3)}`;\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512':\n            return { hash, name: 'HMAC' };\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            return { hash, name: 'RSA-PSS', saltLength: alg.slice(-3) >> 3 };\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            return { hash, name: 'RSASSA-PKCS1-v1_5' };\n        case 'ES256':\n        case 'ES384':\n        case 'ES512':\n            return { hash, name: 'ECDSA', namedCurve: algorithm.namedCurve };\n        case 'EdDSA':\n            return { name: algorithm.name };\n        default:\n            throw new JOSENotSupported(`alg ${alg} is not supported either by JOSE or your javascript runtime`);\n    }\n}\n", "import crypto, { isCryptoKey } from './webcrypto.js';\nimport { checkSigCryptoKey } from '../lib/crypto_key.js';\nimport invalidKeyInput from '../lib/invalid_key_input.js';\nimport { types } from './is_key_like.js';\nexport default function getCryptoKey(alg, key, usage) {\n    if (isCryptoKey(key)) {\n        checkSigCryptoKey(key, alg, usage);\n        return key;\n    }\n    if (key instanceof Uint8Array) {\n        if (!alg.startsWith('HS')) {\n            throw new TypeError(invalidKeyInput(key, ...types));\n        }\n        return crypto.subtle.importKey('raw', key, { hash: `SHA-${alg.slice(-3)}`, name: 'HMAC' }, false, [usage]);\n    }\n    throw new TypeError(invalidKeyInput(key, ...types, 'Uint8Array'));\n}\n", "import subtleAlgorithm from './subtle_dsa.js';\nimport crypto from './webcrypto.js';\nimport checkKeyLength from './check_key_length.js';\nimport getVerifyKey from './get_sign_verify_key.js';\nconst verify = async (alg, key, signature, data) => {\n    const cryptoKey = await getVerifyKey(alg, key, 'verify');\n    checkKeyLength(alg, cryptoKey);\n    const algorithm = subtleAlgorithm(alg, cryptoKey.algorithm);\n    try {\n        return await crypto.subtle.verify(algorithm, cryptoKey, signature, data);\n    }\n    catch {\n        return false;\n    }\n};\nexport default verify;\n", "import { decode as base64url } from '../../runtime/base64url.js';\nimport verify from '../../runtime/verify.js';\nimport { JOSEAlgNotAllowed, JWSInvalid, JWSSignatureVerificationFailed } from '../../util/errors.js';\nimport { concat, encoder, decoder } from '../../lib/buffer_utils.js';\nimport isDisjoint from '../../lib/is_disjoint.js';\nimport isObject from '../../lib/is_object.js';\nimport checkKeyType from '../../lib/check_key_type.js';\nimport validateCrit from '../../lib/validate_crit.js';\nimport validateAlgorithms from '../../lib/validate_algorithms.js';\nexport async function flattenedVerify(jws, key, options) {\n    if (!isObject(jws)) {\n        throw new JWSInvalid('Flattened JWS must be an object');\n    }\n    if (jws.protected === undefined && jws.header === undefined) {\n        throw new JWSInvalid('Flattened JWS must have either of the \"protected\" or \"header\" members');\n    }\n    if (jws.protected !== undefined && typeof jws.protected !== 'string') {\n        throw new JWSInvalid('JWS Protected Header incorrect type');\n    }\n    if (jws.payload === undefined) {\n        throw new JWSInvalid('JWS Payload missing');\n    }\n    if (typeof jws.signature !== 'string') {\n        throw new JWSInvalid('JWS Signature missing or incorrect type');\n    }\n    if (jws.header !== undefined && !isObject(jws.header)) {\n        throw new JWSInvalid('JWS Unprotected Header incorrect type');\n    }\n    let parsedProt = {};\n    if (jws.protected) {\n        try {\n            const protectedHeader = base64url(jws.protected);\n            parsedProt = JSON.parse(decoder.decode(protectedHeader));\n        }\n        catch {\n            throw new JWSInvalid('JWS Protected Header is invalid');\n        }\n    }\n    if (!isDisjoint(parsedProt, jws.header)) {\n        throw new JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');\n    }\n    const joseHeader = {\n        ...parsedProt,\n        ...jws.header,\n    };\n    const extensions = validateCrit(JWSInvalid, new Map([['b64', true]]), options?.crit, parsedProt, joseHeader);\n    let b64 = true;\n    if (extensions.has('b64')) {\n        b64 = parsedProt.b64;\n        if (typeof b64 !== 'boolean') {\n            throw new JWSInvalid('The \"b64\" (base64url-encode payload) Header Parameter must be a boolean');\n        }\n    }\n    const { alg } = joseHeader;\n    if (typeof alg !== 'string' || !alg) {\n        throw new JWSInvalid('JWS \"alg\" (Algorithm) Header Parameter missing or invalid');\n    }\n    const algorithms = options && validateAlgorithms('algorithms', options.algorithms);\n    if (algorithms && !algorithms.has(alg)) {\n        throw new JOSEAlgNotAllowed('\"alg\" (Algorithm) Header Parameter value not allowed');\n    }\n    if (b64) {\n        if (typeof jws.payload !== 'string') {\n            throw new JWSInvalid('JWS Payload must be a string');\n        }\n    }\n    else if (typeof jws.payload !== 'string' && !(jws.payload instanceof Uint8Array)) {\n        throw new JWSInvalid('JWS Payload must be a string or an Uint8Array instance');\n    }\n    let resolvedKey = false;\n    if (typeof key === 'function') {\n        key = await key(parsedProt, jws);\n        resolvedKey = true;\n    }\n    checkKeyType(alg, key, 'verify');\n    const data = concat(encoder.encode(jws.protected ?? ''), encoder.encode('.'), typeof jws.payload === 'string' ? encoder.encode(jws.payload) : jws.payload);\n    let signature;\n    try {\n        signature = base64url(jws.signature);\n    }\n    catch {\n        throw new JWSInvalid('Failed to base64url decode the signature');\n    }\n    const verified = await verify(alg, key, signature, data);\n    if (!verified) {\n        throw new JWSSignatureVerificationFailed();\n    }\n    let payload;\n    if (b64) {\n        try {\n            payload = base64url(jws.payload);\n        }\n        catch {\n            throw new JWSInvalid('Failed to base64url decode the payload');\n        }\n    }\n    else if (typeof jws.payload === 'string') {\n        payload = encoder.encode(jws.payload);\n    }\n    else {\n        payload = jws.payload;\n    }\n    const result = { payload };\n    if (jws.protected !== undefined) {\n        result.protectedHeader = parsedProt;\n    }\n    if (jws.header !== undefined) {\n        result.unprotectedHeader = jws.header;\n    }\n    if (resolvedKey) {\n        return { ...result, key };\n    }\n    return result;\n}\n", "import { flattenedVerify } from '../flattened/verify.js';\nimport { JWSInvalid } from '../../util/errors.js';\nimport { decoder } from '../../lib/buffer_utils.js';\nexport async function compactVerify(jws, key, options) {\n    if (jws instanceof Uint8Array) {\n        jws = decoder.decode(jws);\n    }\n    if (typeof jws !== 'string') {\n        throw new JWSInvalid('Compact JWS must be a string or Uint8Array');\n    }\n    const { 0: protectedHeader, 1: payload, 2: signature, length } = jws.split('.');\n    if (length !== 3) {\n        throw new JWSInvalid('Invalid Compact JWS');\n    }\n    const verified = await flattenedVerify({ payload, protected: protectedHeader, signature }, key, options);\n    const result = { payload: verified.payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n", "export default (date) => Math.floor(date.getTime() / 1000);\n", "const minute = 60;\nconst hour = minute * 60;\nconst day = hour * 24;\nconst week = day * 7;\nconst year = day * 365.25;\nconst REGEX = /^(\\+|\\-)? ?(\\d+|\\d+\\.\\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;\nexport default (str) => {\n    const matched = REGEX.exec(str);\n    if (!matched || (matched[4] && matched[1])) {\n        throw new TypeError('Invalid time period format');\n    }\n    const value = parseFloat(matched[2]);\n    const unit = matched[3].toLowerCase();\n    let numericDate;\n    switch (unit) {\n        case 'sec':\n        case 'secs':\n        case 'second':\n        case 'seconds':\n        case 's':\n            numericDate = Math.round(value);\n            break;\n        case 'minute':\n        case 'minutes':\n        case 'min':\n        case 'mins':\n        case 'm':\n            numericDate = Math.round(value * minute);\n            break;\n        case 'hour':\n        case 'hours':\n        case 'hr':\n        case 'hrs':\n        case 'h':\n            numericDate = Math.round(value * hour);\n            break;\n        case 'day':\n        case 'days':\n        case 'd':\n            numericDate = Math.round(value * day);\n            break;\n        case 'week':\n        case 'weeks':\n        case 'w':\n            numericDate = Math.round(value * week);\n            break;\n        default:\n            numericDate = Math.round(value * year);\n            break;\n    }\n    if (matched[1] === '-' || matched[4] === 'ago') {\n        return -numericDate;\n    }\n    return numericDate;\n};\n", "import { JWTClaimValidationFailed, JWTExpired, JWTInvalid } from '../util/errors.js';\nimport { decoder } from './buffer_utils.js';\nimport epoch from './epoch.js';\nimport secs from './secs.js';\nimport isObject from './is_object.js';\nconst normalizeTyp = (value) => value.toLowerCase().replace(/^application\\//, '');\nconst checkAudiencePresence = (audPayload, audOption) => {\n    if (typeof audPayload === 'string') {\n        return audOption.includes(audPayload);\n    }\n    if (Array.isArray(audPayload)) {\n        return audOption.some(Set.prototype.has.bind(new Set(audPayload)));\n    }\n    return false;\n};\nexport default (protectedHeader, encodedPayload, options = {}) => {\n    const { typ } = options;\n    if (typ &&\n        (typeof protectedHeader.typ !== 'string' ||\n            normalizeTyp(protectedHeader.typ) !== normalizeTyp(typ))) {\n        throw new JWTClaimValidationFailed('unexpected \"typ\" JWT header value', 'typ', 'check_failed');\n    }\n    let payload;\n    try {\n        payload = JSON.parse(decoder.decode(encodedPayload));\n    }\n    catch {\n    }\n    if (!isObject(payload)) {\n        throw new JWTInvalid('JWT Claims Set must be a top-level JSON object');\n    }\n    const { requiredClaims = [], issuer, subject, audience, maxTokenAge } = options;\n    const presenceCheck = [...requiredClaims];\n    if (maxTokenAge !== undefined)\n        presenceCheck.push('iat');\n    if (audience !== undefined)\n        presenceCheck.push('aud');\n    if (subject !== undefined)\n        presenceCheck.push('sub');\n    if (issuer !== undefined)\n        presenceCheck.push('iss');\n    for (const claim of new Set(presenceCheck.reverse())) {\n        if (!(claim in payload)) {\n            throw new JWTClaimValidationFailed(`missing required \"${claim}\" claim`, claim, 'missing');\n        }\n    }\n    if (issuer && !(Array.isArray(issuer) ? issuer : [issuer]).includes(payload.iss)) {\n        throw new JWTClaimValidationFailed('unexpected \"iss\" claim value', 'iss', 'check_failed');\n    }\n    if (subject && payload.sub !== subject) {\n        throw new JWTClaimValidationFailed('unexpected \"sub\" claim value', 'sub', 'check_failed');\n    }\n    if (audience &&\n        !checkAudiencePresence(payload.aud, typeof audience === 'string' ? [audience] : audience)) {\n        throw new JWTClaimValidationFailed('unexpected \"aud\" claim value', 'aud', 'check_failed');\n    }\n    let tolerance;\n    switch (typeof options.clockTolerance) {\n        case 'string':\n            tolerance = secs(options.clockTolerance);\n            break;\n        case 'number':\n            tolerance = options.clockTolerance;\n            break;\n        case 'undefined':\n            tolerance = 0;\n            break;\n        default:\n            throw new TypeError('Invalid clockTolerance option type');\n    }\n    const { currentDate } = options;\n    const now = epoch(currentDate || new Date());\n    if ((payload.iat !== undefined || maxTokenAge) && typeof payload.iat !== 'number') {\n        throw new JWTClaimValidationFailed('\"iat\" claim must be a number', 'iat', 'invalid');\n    }\n    if (payload.nbf !== undefined) {\n        if (typeof payload.nbf !== 'number') {\n            throw new JWTClaimValidationFailed('\"nbf\" claim must be a number', 'nbf', 'invalid');\n        }\n        if (payload.nbf > now + tolerance) {\n            throw new JWTClaimValidationFailed('\"nbf\" claim timestamp check failed', 'nbf', 'check_failed');\n        }\n    }\n    if (payload.exp !== undefined) {\n        if (typeof payload.exp !== 'number') {\n            throw new JWTClaimValidationFailed('\"exp\" claim must be a number', 'exp', 'invalid');\n        }\n        if (payload.exp <= now - tolerance) {\n            throw new JWTExpired('\"exp\" claim timestamp check failed', 'exp', 'check_failed');\n        }\n    }\n    if (maxTokenAge) {\n        const age = now - payload.iat;\n        const max = typeof maxTokenAge === 'number' ? maxTokenAge : secs(maxTokenAge);\n        if (age - tolerance > max) {\n            throw new JWTExpired('\"iat\" claim timestamp check failed (too far in the past)', 'iat', 'check_failed');\n        }\n        if (age < 0 - tolerance) {\n            throw new JWTClaimValidationFailed('\"iat\" claim timestamp check failed (it should be in the past)', 'iat', 'check_failed');\n        }\n    }\n    return payload;\n};\n", "import { compactVerify } from '../jws/compact/verify.js';\nimport jwtPayload from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n    const verified = await compactVerify(jwt, key, options);\n    if (verified.protectedHeader.crit?.includes('b64') && verified.protectedHeader.b64 === false) {\n        throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n    }\n    const payload = jwtPayload(verified.protectedHeader, verified.payload, options);\n    const result = { payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n", "import { importJWK } from '../key/import.js';\nimport { JWKSInvalid, JOSENotSupported, JWKSNoMatchingKey, JWKSMultipleMatchingKeys, } from '../util/errors.js';\nimport isObject from '../lib/is_object.js';\nfunction getKtyFromAlg(alg) {\n    switch (typeof alg === 'string' && alg.slice(0, 2)) {\n        case 'RS':\n        case 'PS':\n            return 'RSA';\n        case 'ES':\n            return 'EC';\n        case 'Ed':\n            return 'OKP';\n        default:\n            throw new JOSENotSupported('Unsupported \"alg\" value for a JSON Web Key Set');\n    }\n}\nexport function isJWKSLike(jwks) {\n    return (jwks &&\n        typeof jwks === 'object' &&\n        Array.isArray(jwks.keys) &&\n        jwks.keys.every(isJWKLike));\n}\nfunction isJWKLike(key) {\n    return isObject(key);\n}\nfunction clone(obj) {\n    if (typeof structuredClone === 'function') {\n        return structuredClone(obj);\n    }\n    return JSON.parse(JSON.stringify(obj));\n}\nexport class LocalJWKSet {\n    constructor(jwks) {\n        this._cached = new WeakMap();\n        if (!isJWKSLike(jwks)) {\n            throw new JWKSInvalid('JSON Web Key Set malformed');\n        }\n        this._jwks = clone(jwks);\n    }\n    async getKey(protectedHeader, token) {\n        const { alg, kid } = { ...protectedHeader, ...token?.header };\n        const kty = getKtyFromAlg(alg);\n        const candidates = this._jwks.keys.filter((jwk) => {\n            let candidate = kty === jwk.kty;\n            if (candidate && typeof kid === 'string') {\n                candidate = kid === jwk.kid;\n            }\n            if (candidate && typeof jwk.alg === 'string') {\n                candidate = alg === jwk.alg;\n            }\n            if (candidate && typeof jwk.use === 'string') {\n                candidate = jwk.use === 'sig';\n            }\n            if (candidate && Array.isArray(jwk.key_ops)) {\n                candidate = jwk.key_ops.includes('verify');\n            }\n            if (candidate && alg === 'EdDSA') {\n                candidate = jwk.crv === 'Ed25519' || jwk.crv === 'Ed448';\n            }\n            if (candidate) {\n                switch (alg) {\n                    case 'ES256':\n                        candidate = jwk.crv === 'P-256';\n                        break;\n                    case 'ES256K':\n                        candidate = jwk.crv === 'secp256k1';\n                        break;\n                    case 'ES384':\n                        candidate = jwk.crv === 'P-384';\n                        break;\n                    case 'ES512':\n                        candidate = jwk.crv === 'P-521';\n                        break;\n                }\n            }\n            return candidate;\n        });\n        const { 0: jwk, length } = candidates;\n        if (length === 0) {\n            throw new JWKSNoMatchingKey();\n        }\n        else if (length !== 1) {\n            const error = new JWKSMultipleMatchingKeys();\n            const { _cached } = this;\n            error[Symbol.asyncIterator] = async function* () {\n                for (const jwk of candidates) {\n                    try {\n                        yield await importWithAlgCache(_cached, jwk, alg);\n                    }\n                    catch {\n                        continue;\n                    }\n                }\n            };\n            throw error;\n        }\n        return importWithAlgCache(this._cached, jwk, alg);\n    }\n}\nasync function importWithAlgCache(cache, jwk, alg) {\n    const cached = cache.get(jwk) || cache.set(jwk, {}).get(jwk);\n    if (cached[alg] === undefined) {\n        const key = await importJWK({ ...jwk, ext: true }, alg);\n        if (key instanceof Uint8Array || key.type !== 'public') {\n            throw new JWKSInvalid('JSON Web Key Set members must be public keys');\n        }\n        cached[alg] = key;\n    }\n    return cached[alg];\n}\nexport function createLocalJWKSet(jwks) {\n    const set = new LocalJWKSet(jwks);\n    return async function (protectedHeader, token) {\n        return set.getKey(protectedHeader, token);\n    };\n}\n", "import { JOSEError, JWKSTimeout } from '../util/errors.js';\nconst fetchJwks = async (url, timeout, options) => {\n    let controller;\n    let id;\n    let timedOut = false;\n    if (typeof AbortController === 'function') {\n        controller = new AbortController();\n        id = setTimeout(() => {\n            timedOut = true;\n            controller.abort();\n        }, timeout);\n    }\n    const response = await fetch(url.href, {\n        signal: controller ? controller.signal : undefined,\n        redirect: 'manual',\n        headers: options.headers,\n    }).catch((err) => {\n        if (timedOut)\n            throw new JWKSTimeout();\n        throw err;\n    });\n    if (id !== undefined)\n        clearTimeout(id);\n    if (response.status !== 200) {\n        throw new JOSEError('Expected 200 OK from the JSON Web Key Set HTTP response');\n    }\n    try {\n        return await response.json();\n    }\n    catch {\n        throw new JOSEError('Failed to parse the JSON Web Key Set HTTP response as JSON');\n    }\n};\nexport default fetchJwks;\n", "import fetchJwks from '../runtime/fetch_jwks.js';\nimport { JWKSInvalid, JWKSNoMatchingKey } from '../util/errors.js';\nimport { isJWKSLike, LocalJWKSet } from './local.js';\nfunction isCloudflareWorkers() {\n    return (typeof WebSocketPair !== 'undefined' ||\n        (typeof navigator !== 'undefined' && navigator.userAgent === 'Cloudflare-Workers') ||\n        (typeof EdgeRuntime !== 'undefined' && EdgeRuntime === 'vercel'));\n}\nlet USER_AGENT;\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\n    const NAME = 'jose';\n    const VERSION = 'v5.2.0';\n    USER_AGENT = `${NAME}/${VERSION}`;\n}\nclass RemoteJWKSet extends LocalJWKSet {\n    constructor(url, options) {\n        super({ keys: [] });\n        this._jwks = undefined;\n        if (!(url instanceof URL)) {\n            throw new TypeError('url must be an instance of URL');\n        }\n        this._url = new URL(url.href);\n        this._options = { agent: options?.agent, headers: options?.headers };\n        this._timeoutDuration =\n            typeof options?.timeoutDuration === 'number' ? options?.timeoutDuration : 5000;\n        this._cooldownDuration =\n            typeof options?.cooldownDuration === 'number' ? options?.cooldownDuration : 30000;\n        this._cacheMaxAge = typeof options?.cacheMaxAge === 'number' ? options?.cacheMaxAge : 600000;\n    }\n    coolingDown() {\n        return typeof this._jwksTimestamp === 'number'\n            ? Date.now() < this._jwksTimestamp + this._cooldownDuration\n            : false;\n    }\n    fresh() {\n        return typeof this._jwksTimestamp === 'number'\n            ? Date.now() < this._jwksTimestamp + this._cacheMaxAge\n            : false;\n    }\n    async getKey(protectedHeader, token) {\n        if (!this._jwks || !this.fresh()) {\n            await this.reload();\n        }\n        try {\n            return await super.getKey(protectedHeader, token);\n        }\n        catch (err) {\n            if (err instanceof JWKSNoMatchingKey) {\n                if (this.coolingDown() === false) {\n                    await this.reload();\n                    return super.getKey(protectedHeader, token);\n                }\n            }\n            throw err;\n        }\n    }\n    async reload() {\n        if (this._pendingFetch && isCloudflareWorkers()) {\n            this._pendingFetch = undefined;\n        }\n        const headers = new Headers(this._options.headers);\n        if (USER_AGENT && !headers.has('User-Agent')) {\n            headers.set('User-Agent', USER_AGENT);\n            this._options.headers = Object.fromEntries(headers.entries());\n        }\n        this._pendingFetch || (this._pendingFetch = fetchJwks(this._url, this._timeoutDuration, this._options)\n            .then((json) => {\n            if (!isJWKSLike(json)) {\n                throw new JWKSInvalid('JSON Web Key Set malformed');\n            }\n            this._jwks = { keys: json.keys };\n            this._jwksTimestamp = Date.now();\n            this._pendingFetch = undefined;\n        })\n            .catch((err) => {\n            this._pendingFetch = undefined;\n            throw err;\n        }));\n        await this._pendingFetch;\n    }\n}\nexport function createRemoteJWKSet(url, options) {\n    const set = new RemoteJWKSet(url, options);\n    return async function (protectedHeader, token) {\n        return set.getKey(protectedHeader, token);\n    };\n}\n", "import * as base64url from '../runtime/base64url.js';\nexport const encode = base64url.encode;\nexport const decode = base64url.decode;\n", "import '../consts/index.js';\nimport { ReservedScope, UserScope } from '../consts/openid.js';\n\n/**\n * @param originalScopes\n * @return scopes should contain all default scopes (`openid`, `offline_access` and `profile`)\n */\nconst withDefaultScopes = (originalScopes) => {\n    const reservedScopes = Object.values(ReservedScope);\n    const uniqueScopes = new Set([...reservedScopes, UserScope.Profile, ...(originalScopes ?? [])]);\n    return Array.from(uniqueScopes).join(' ');\n};\n\nexport { withDefaultScopes };\n", "import { QueryKey, Prompt } from '../consts/index.js';\nimport '@silverhand/essentials';\nimport 'jose';\nimport { withDefaultScopes } from '../utils/scopes.js';\n\nconst codeChallengeMethod = 'S256';\nconst responseType = 'code';\nconst generateSignInUri = ({ authorizationEndpoint, clientId, redirectUri, codeChallenge, state, scopes, resources, prompt, interactionMode, }) => {\n    const urlSearchParameters = new URLSearchParams({\n        [QueryKey.ClientId]: clientId,\n        [QueryKey.RedirectUri]: redirectUri,\n        [QueryKey.CodeChallenge]: codeChallenge,\n        [QueryKey.CodeChallengeMethod]: codeChallengeMethod,\n        [QueryKey.State]: state,\n        [QueryKey.ResponseType]: responseType,\n        [QueryKey.Prompt]: prompt ?? Prompt.Consent,\n        [QueryKey.Scope]: withDefaultScopes(scopes),\n    });\n    for (const resource of resources ?? []) {\n        urlSearchParameters.append(QueryKey.Resource, resource);\n    }\n    // Set interactionMode to signUp for a create account user experience\n    if (interactionMode) {\n        urlSearchParameters.append(QueryKey.InteractionMode, interactionMode);\n    }\n    return `${authorizationEndpoint}?${urlSearchParameters.toString()}`;\n};\n\nexport { generateSignInUri };\n", "import { QueryKey } from '../consts/index.js';\n\nconst generateSignOutUri = ({ endSessionEndpoint, clientId, postLogoutRedirectUri, }) => {\n    const urlSearchParameters = new URLSearchParams({ [QueryKey.ClientId]: clientId });\n    if (postLogoutRedirectUri) {\n        urlSearchParameters.append(QueryKey.PostLogoutRedirectUri, postLogoutRedirectUri);\n    }\n    return `${endSessionEndpoint}?${urlSearchParameters.toString()}`;\n};\n\nexport { generateSignOutUri };\n", "const fetchUserInfo = async (userInfoEndpoint, accessToken, requester) => requester(userInfoEndpoint, {\n    headers: { Authorization: `Bearer ${accessToken}` },\n});\n\nexport { fetchUserInfo };\n", "const isArbitraryObject = (data) => typeof data === 'object' && data !== null;\n\nexport { isArbitraryObject };\n", "import { isArbitraryObject } from './arbitrary-object.js';\n\nconst logtoErrorCodes = Object.freeze({\n    'id_token.invalid_iat': 'Invalid issued at time in the ID token',\n    'id_token.invalid_token': 'Invalid ID token',\n    'callback_uri_verification.redirect_uri_mismatched': 'The callback URI mismatches the redirect URI.',\n    'callback_uri_verification.error_found': 'Error found in the callback URI',\n    'callback_uri_verification.missing_state': 'Missing state in the callback URI',\n    'callback_uri_verification.state_mismatched': 'State mismatched in the callback URI',\n    'callback_uri_verification.missing_code': 'Missing code in the callback URI',\n    crypto_subtle_unavailable: 'Crypto.subtle is unavailable in insecure contexts (non-HTTPS).',\n    unexpected_response_error: 'Unexpected response error from the server.',\n});\nclass LogtoError extends Error {\n    constructor(code, data) {\n        super(logtoErrorCodes[code]);\n        this.code = code;\n        this.data = data;\n    }\n}\nconst isLogtoRequestError = (data) => {\n    if (!isArbitraryObject(data)) {\n        return false;\n    }\n    return typeof data.code === 'string' && typeof data.message === 'string';\n};\nclass LogtoRequestError extends Error {\n    constructor(code, message) {\n        super(message);\n        this.code = code;\n    }\n}\nclass OidcError {\n    constructor(error, errorDescription) {\n        this.error = error;\n        this.errorDescription = errorDescription;\n    }\n}\n\nexport { LogtoError, LogtoRequestError, OidcError, isLogtoRequestError };\n", "import { conditional } from '@silverhand/essentials';\nimport { QueryKey } from '../consts/index.js';\nimport { LogtoError, OidcError } from './errors.js';\n\nconst parseUriParameters = (uri) => {\n    const [, queryString = ''] = uri.split('?');\n    return new URLSearchParams(queryString);\n};\nconst verifyAndParseCodeFromCallbackUri = (callbackUri, redirectUri, state) => {\n    if (!callbackUri.startsWith(redirectUri)) {\n        throw new LogtoError('callback_uri_verification.redirect_uri_mismatched');\n    }\n    const uriParameters = parseUriParameters(callbackUri);\n    const error = conditional(uriParameters.get(QueryKey.Error));\n    const errorDescription = conditional(uriParameters.get(QueryKey.ErrorDescription));\n    if (error) {\n        throw new LogtoError('callback_uri_verification.error_found', new OidcError(error, errorDescription));\n    }\n    const stateFromCallbackUri = uriParameters.get(QueryKey.State);\n    if (!stateFromCallbackUri) {\n        throw new LogtoError('callback_uri_verification.missing_state');\n    }\n    if (stateFromCallbackUri !== state) {\n        throw new LogtoError('callback_uri_verification.state_mismatched');\n    }\n    const code = uriParameters.get(QueryKey.Code);\n    if (!code) {\n        throw new LogtoError('callback_uri_verification.missing_code');\n    }\n    return code;\n};\n\nexport { parseUriParameters, verifyAndParseCodeFromCallbackUri };\n", "import { urlSafeBase64 } from '@silverhand/essentials';\nimport { jwtVerify } from 'jose';\nimport { isArbitraryObject } from './arbitrary-object.js';\nimport { LogtoError } from './errors.js';\n\nconst issuedAtTimeTolerance = 300; // 5 minutes\n/* eslint-disable complexity */\n/**\n * @link [ID Token](https://openid.net/specs/openid-connect-core-1_0.html#IDToken)\n */\nfunction assertIdTokenClaims(data) {\n    if (!isArbitraryObject(data)) {\n        throw new TypeError('IdToken is expected to be an object');\n    }\n    for (const key of ['iss', 'sub', 'aud']) {\n        if (typeof data[key] !== 'string') {\n            throw new TypeError(`At path: IdToken.${key}: expected a string`);\n        }\n    }\n    for (const key of ['exp', 'iat']) {\n        if (typeof data[key] !== 'number') {\n            throw new TypeError(`At path: IdToken.${key}: expected a number`);\n        }\n    }\n    for (const key of ['at_hash', 'name', 'username', 'picture', 'email', 'phone_number']) {\n        if (data[key] === undefined) {\n            continue;\n        }\n        if (typeof data[key] !== 'string' && data[key] !== null) {\n            throw new TypeError(`At path: IdToken.${key}: expected null or a string`);\n        }\n    }\n    for (const key of ['email_verified', 'phone_number_verified']) {\n        if (data[key] === undefined) {\n            continue;\n        }\n        if (typeof data[key] !== 'boolean') {\n            throw new TypeError(`At path: IdToken.${key}: expected a boolean`);\n        }\n    }\n}\n/* eslint-enable complexity */\nconst verifyIdToken = async (idToken, clientId, issuer, jwks) => {\n    const result = await jwtVerify(idToken, jwks, { audience: clientId, issuer });\n    if (Math.abs((result.payload.iat ?? 0) - Date.now() / 1000) > issuedAtTimeTolerance) {\n        throw new LogtoError('id_token.invalid_iat');\n    }\n};\nconst decodeIdToken = (token) => {\n    const { 1: encodedPayload } = token.split('.');\n    if (!encodedPayload) {\n        throw new LogtoError('id_token.invalid_token');\n    }\n    const json = urlSafeBase64.decode(encodedPayload);\n    const idTokenClaims = JSON.parse(json);\n    assertIdTokenClaims(idTokenClaims);\n    return idTokenClaims;\n};\n\nexport { decodeIdToken, verifyIdToken };\n", "import { urlSafeBase64 } from '@silverhand/essentials';\nimport { isArbitraryObject } from './arbitrary-object.js';\n\n// https://docs.logto.io/docs/recipes/protect-your-api/\nfunction assertAccessTokenClaims(data) {\n    if (!isArbitraryObject(data)) {\n        throw new TypeError('AccessToken is expected to be an object');\n    }\n    for (const key of ['jti', 'iss', 'sub', 'aud', 'client_id', 'scope']) {\n        if (data[key] === undefined) {\n            continue;\n        }\n        if (typeof data[key] !== 'string' && data[key] !== null) {\n            throw new TypeError(`At path: AccessToken.${key}: expected null or a string`);\n        }\n    }\n    for (const key of ['exp', 'iat']) {\n        if (data[key] === undefined) {\n            continue;\n        }\n        if (typeof data[key] !== 'number' && data[key] !== null) {\n            throw new TypeError(`At path: AccessToken.${key}: expected null or a number`);\n        }\n    }\n}\nconst decodeAccessToken = (accessToken) => {\n    const { 1: encodedPayload } = accessToken.split('.');\n    if (!encodedPayload) {\n        // Non-JWT format token string\n        return {};\n    }\n    const json = urlSafeBase64.decode(encodedPayload);\n    const accessTokenClaims = JSON.parse(json);\n    assertAccessTokenClaims(accessTokenClaims);\n    return accessTokenClaims;\n};\n\nexport { decodeAccessToken };\n", "var PersistKey;\n(function (PersistKey) {\n    PersistKey[\"IdToken\"] = \"idToken\";\n    PersistKey[\"RefreshToken\"] = \"refreshToken\";\n    PersistKey[\"AccessToken\"] = \"accessToken\";\n    PersistKey[\"SignInSession\"] = \"signInSession\";\n})(PersistKey || (PersistKey = {}));\nvar CacheKey;\n(function (CacheKey) {\n    /**\n     * OpenID Configuration endpoint response.\n     *\n     * @see {@link https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderConfigurationResponse | OpenID Connect Discovery 1.0}\n     */\n    CacheKey[\"OpenidConfig\"] = \"openidConfiguration\";\n    /**\n     * The content of OpenID Provider's `jwks_uri` (JSON Web Key Set).\n     *\n     * @see {@link https://openid.net/specs/openid-connect-discovery-1_0-21.html#ProviderMetadata | OpenID Connect Discovery 1.0}\n     */\n    CacheKey[\"Jwks\"] = \"jwks\";\n})(CacheKey || (CacheKey = {}));\n\nexport { CacheKey, PersistKey };\n", "import { trySafe, conditional } from '@silverhand/essentials';\nexport { CacheKey, PersistKey } from './types.js';\n\nclass ClientAdapterInstance {\n    /* END OF IMPLEMENTATION */\n    constructor(adapter) {\n        // eslint-disable-next-line @silverhand/fp/no-mutating-assign\n        Object.assign(this, adapter);\n    }\n    async setStorageItem(key, value) {\n        if (!value) {\n            await this.storage.removeItem(key);\n            return;\n        }\n        await this.storage.setItem(key, value);\n    }\n    /**\n     * Try to get the string value from the cache and parse as JSON.\n     * Return the parsed value if it is an object, return `undefined` otherwise.\n     *\n     * @param key The cache key to get value from.\n     */\n    async getCachedObject(key) {\n        const cached = await trySafe(async () => {\n            const data = await this.unstable_cache?.getItem(key);\n            // It's actually `unknown`\n            // eslint-disable-next-line no-restricted-syntax\n            return conditional(data && JSON.parse(data));\n        });\n        if (cached && typeof cached === 'object') {\n            // Trust cache for now\n            // eslint-disable-next-line no-restricted-syntax\n            return cached;\n        }\n    }\n    /**\n     * Try to get the value from the cache first, if it doesn't exist in cache,\n     * run the getter function and store the result into cache.\n     *\n     * @param key The cache key to get value from.\n     */\n    async getWithCache(key, getter) {\n        const cached = await this.getCachedObject(key);\n        if (cached) {\n            return cached;\n        }\n        const result = await getter();\n        await this.unstable_cache?.setItem(key, JSON.stringify(result));\n        return result;\n    }\n}\n\nexport { ClientAdapterInstance };\n", "import { UserScope } from '@logto/js';\n\nconst logtoClientErrorCodes = Object.freeze({\n    'sign_in_session.invalid': 'Invalid sign-in session.',\n    'sign_in_session.not_found': 'Sign-in session not found.',\n    not_authenticated: 'Not authenticated.',\n    fetch_user_info_failed: 'Unable to fetch user info. The access token may be invalid.',\n    user_cancelled: 'The user cancelled the action.',\n    missing_scope_organizations: `The \\`${UserScope.Organizations}\\` scope is required`,\n});\nclass LogtoClientError extends Error {\n    constructor(code, data) {\n        super(logtoClientErrorCodes[code]);\n        this.name = 'LogtoClientError';\n        this.code = code;\n        this.data = data;\n    }\n}\n\nexport { LogtoClientError };\n", "import { isObject } from '@silverhand/essentials';\nimport { createLocalJWKSet } from 'jose';\nimport { CacheKey } from './adapter/types.js';\n\n// Edited from jose's internal util `isJWKSLike`\nfunction isJwkSetLike(jwkSet) {\n    return Boolean(jwkSet &&\n        typeof jwkSet === 'object' &&\n        'keys' in jwkSet &&\n        Array.isArray(jwkSet.keys) &&\n        jwkSet.keys.every((element) => isObject(element)));\n}\nclass CachedRemoteJwkSet {\n    constructor(url, adapter) {\n        this.url = url;\n        this.adapter = adapter;\n        if (!adapter.unstable_cache) {\n            throw new Error(\"No cache found in the client adapter. Use `createRemoteJWKSet()` from 'jose' instead.\");\n        }\n    }\n    async getKey(...args) {\n        if (!this.jwkSet) {\n            this.jwkSet = await this.#load();\n        }\n        try {\n            return await this.#getLocalKey(...args);\n        }\n        catch (error) {\n            // Jose does not export the error definition\n            // Found in https://github.com/panva/jose/blob/d5b3cb672736112b1e1e31ac4d5e9cd641675206/src/util/errors.ts#L347\n            if (error instanceof Error && 'code' in error && error.code === 'ERR_JWKS_NO_MATCHING_KEY') {\n                this.jwkSet = await this.#load();\n                return this.#getLocalKey(...args);\n            }\n            throw error;\n        }\n    }\n    async #load() {\n        return this.adapter.getWithCache(CacheKey.Jwks, async () => {\n            const controller = new AbortController();\n            const response = await fetch(this.url, { signal: controller.signal, redirect: 'manual' });\n            if (!response.ok) {\n                throw new Error('Expected OK from the JSON Web Key Set HTTP response');\n            }\n            const json = await response.json();\n            if (!isJwkSetLike(json)) {\n                throw new Error('JSON Web Key Set malformed');\n            }\n            return json;\n        });\n    }\n    async #getLocalKey(...args) {\n        if (!this.jwkSet) {\n            throw new Error('No local JWK Set found.');\n        }\n        return createLocalJWKSet(this.jwkSet)(...args);\n    }\n}\n\nexport { CachedRemoteJwkSet };\n", "import { Prompt, withDefaultScopes, UserScope, ReservedResource, isArbitraryObject } from '@logto/js';\nimport { deduplicate } from '@silverhand/essentials';\n\n/**\n * Normalize the Logto client configuration per the following rules:\n *\n * - Add default scopes (`openid`, `offline_access` and `profile`) if not provided.\n * - Add {@link ReservedResource.Organization} to resources if {@link UserScope.Organizations} is included in scopes.\n *\n * @param config The Logto client configuration to be normalized.\n * @returns The normalized Logto client configuration.\n */\nconst normalizeLogtoConfig = (config) => {\n    const { prompt = Prompt.Consent, scopes = [], resources, ...rest } = config;\n    return {\n        ...rest,\n        prompt,\n        scopes: withDefaultScopes(scopes).split(' '),\n        resources: scopes.includes(UserScope.Organizations)\n            ? deduplicate([...(resources ?? []), ReservedResource.Organization])\n            : resources,\n    };\n};\nconst isLogtoSignInSessionItem = (data) => {\n    if (!isArbitraryObject(data)) {\n        return false;\n    }\n    return ['redirectUri', 'codeVerifier', 'state'].every((key) => typeof data[key] === 'string');\n};\nconst isLogtoAccessTokenMap = (data) => {\n    if (!isArbitraryObject(data)) {\n        return false;\n    }\n    return Object.values(data).every((value) => {\n        if (!isArbitraryObject(value)) {\n            return false;\n        }\n        return (typeof value.token === 'string' &&\n            typeof value.scope === 'string' &&\n            typeof value.expiresAt === 'number');\n    });\n};\n\nexport { isLogtoAccessTokenMap, isLogtoSignInSessionItem, normalizeLogtoConfig };\n", "import { discoveryPath } from '@logto/js';\nimport { conditionalString } from '@silverhand/essentials';\n\nconst buildAccessTokenKey = (resource = '', organizationId, scopes = []) => `${scopes.slice().sort().join(' ')}@${resource}${conditionalString(organizationId && `#${organizationId}`)}`;\nconst getDiscoveryEndpoint = (endpoint) => new URL(discoveryPath, endpoint).toString();\n\nexport { buildAccessTokenKey, getDiscoveryEndpoint };\n", "function memoize(run) {\n    const promiseCache = new Map();\n    const memoized = async function (...args) {\n        const promiseKey = args[0];\n        const cachedPromise = promiseCache.get(promiseKey);\n        if (cachedPromise) {\n            return cachedPromise;\n        }\n        const promise = (async () => {\n            try {\n                return await run.apply(this, args);\n            }\n            finally {\n                promiseCache.delete(promiseKey);\n            }\n        })();\n        promiseCache.set(promiseKey, promise);\n        return promise;\n    };\n    return memoized;\n}\n\nexport { memoize };\n", "// TODO @sijie move to essentials\n/* eslint-disable @silverhand/fp/no-let */\n/* eslint-disable @silverhand/fp/no-mutation */\nfunction once(function_) {\n    let called = false;\n    let result;\n    return function (...args) {\n        if (!called) {\n            called = true;\n            result = function_.apply(this, args);\n        }\n        return result;\n    };\n}\n/* eslint-enable @silverhand/fp/no-mutation */\n/* eslint-enable @silverhand/fp/no-let */\n\nexport { once };\n", "import { isLogtoRequestError, LogtoError, LogtoRequestError } from '@logto/js';\n\n/**\n * A factory function that creates a requester by accepting a `fetch`-like function.\n *\n * @param fetchFunction A `fetch`-like function.\n * @returns A requester function.\n * @see {@link Requester}\n */\nconst createRequester = (fetchFunction) => {\n    return async (...args) => {\n        const response = await fetchFunction(...args);\n        if (!response.ok) {\n            const responseJson = await response.json();\n            if (!isLogtoRequestError(responseJson)) {\n                throw new LogtoError('unexpected_response_error', responseJson);\n            }\n            // Expected request error from server\n            const { code, message } = responseJson;\n            throw new LogtoRequestError(code, message);\n        }\n        return response.json();\n    };\n};\n\nexport { createRequester };\n", "import { decodeIdToken, decodeAccessToken, fetchUserInfo, generateSignInUri, revoke, generateSignOutUri, fetchTokenByRefreshToken, verifyIdToken, fetchOidcConfig, UserScope, verifyAndParseCodeFromCallbackUri, fetchTokenByAuthorizationCode } from '@logto/js';\nexport { LogtoError, LogtoRequestError, OidcError, Prompt, ReservedResource, ReservedScope, UserScope, buildOrganizationUrn, getOrganizationIdFromUrn, organizationUrnPrefix } from '@logto/js';\nimport { createRemoteJWKSet } from 'jose';\nimport { ClientAdapterInstance } from './adapter/index.js';\nimport { LogtoClientError } from './errors.js';\nimport { CachedRemoteJwkSet } from './remote-jwk-set.js';\nimport { normalizeLogtoConfig, isLogtoSignInSessionItem, isLogtoAccessTokenMap } from './types/index.js';\nimport { buildAccessTokenKey, getDiscoveryEndpoint } from './utils/index.js';\nimport { memoize } from './utils/memoize.js';\nimport { once } from './utils/once.js';\nimport { PersistKey, CacheKey } from './adapter/types.js';\nexport { createRequester } from './utils/requester.js';\n\n/* eslint-disable max-lines */\n/**\n * The Logto base client class that provides the essential methods for\n * interacting with the Logto server.\n *\n * It also provides an adapter object that allows the customizations of the\n * client behavior for different environments.\n */\nclass LogtoClient {\n    constructor(logtoConfig, adapter) {\n        /**\n         * Get the OIDC configuration from the discovery endpoint. This method will\n         * only fetch the configuration once and cache the result.\n         */\n        this.getOidcConfig = once(this.#getOidcConfig);\n        /**\n         * Get the access token from the storage with refresh strategy.\n         *\n         * - If the access token has expired, it will try to fetch a new one using the Refresh Token.\n         * - If there's an ongoing Promise to fetch the access token, it will return the Promise.\n         *\n         * If you want to get the access token claims, use {@link getAccessTokenClaims} instead.\n         *\n         * @param resource The resource that the access token is granted for. If not\n         * specified, the access token will be used for OpenID Connect or the default\n         * resource, as specified in the Logto Console.\n         * @returns The access token string.\n         * @throws LogtoClientError if the user is not authenticated.\n         */\n        this.getAccessToken = memoize(this.#getAccessToken);\n        /**\n         * Get the access token for the specified organization from the storage with refresh strategy.\n         *\n         * Scope {@link UserScope.Organizations} is required in the config to use organization-related\n         * methods.\n         *\n         * @param organizationId The ID of the organization that the access token is granted for.\n         * @returns The access token string.\n         * @throws LogtoClientError if the user is not authenticated.\n         * @remarks\n         * It uses the same refresh strategy as {@link getAccessToken}.\n         */\n        this.getOrganizationToken = memoize(this.#getOrganizationToken);\n        /**\n         * Handle the sign-in callback by parsing the authorization code from the\n         * callback URI and exchanging it for the tokens.\n         *\n         * @param callbackUri The callback URI, including the search params, that the user is redirected to after the sign-in flow is completed.\n         * The origin and pathname of this URI must match the origin and pathname of the redirect URI specified in {@link signIn}.\n         * In many cases you'll probably end up passing `window.location.href` as the argument to this function.\n         * @throws LogtoClientError if the sign-in session is not found.\n         */\n        this.handleSignInCallback = memoize(this.#handleSignInCallback);\n        this.getJwtVerifyGetKey = once(this.#getJwtVerifyGetKey);\n        this.accessTokenMap = new Map();\n        this.logtoConfig = normalizeLogtoConfig(logtoConfig);\n        this.adapter = new ClientAdapterInstance(adapter);\n        void this.loadAccessTokenMap();\n    }\n    /**\n     * Check if the user is authenticated by checking if the ID token exists.\n     */\n    async isAuthenticated() {\n        return Boolean(await this.getIdToken());\n    }\n    /**\n     * Get the Refresh Token from the storage.\n     */\n    async getRefreshToken() {\n        return this.adapter.storage.getItem('refreshToken');\n    }\n    /**\n     * Get the ID Token from the storage. If you want to get the ID Token claims,\n     * use {@link getIdTokenClaims} instead.\n     */\n    async getIdToken() {\n        return this.adapter.storage.getItem('idToken');\n    }\n    /**\n     * Get the ID Token claims.\n     */\n    async getIdTokenClaims() {\n        const idToken = await this.getIdToken();\n        if (!idToken) {\n            throw new LogtoClientError('not_authenticated');\n        }\n        return decodeIdToken(idToken);\n    }\n    /**\n     * Get the access token claims for the specified resource.\n     *\n     * @param resource The resource that the access token is granted for. If not\n     * specified, the access token will be used for OpenID Connect or the default\n     * resource, as specified in the Logto Console.\n     */\n    async getAccessTokenClaims(resource) {\n        const accessToken = await this.getAccessToken(resource);\n        return decodeAccessToken(accessToken);\n    }\n    /**\n     * Get the organization token claims for the specified organization.\n     *\n     * @param organizationId The ID of the organization that the access token is granted for.\n     */\n    async getOrganizationTokenClaims(organizationId) {\n        const accessToken = await this.getOrganizationToken(organizationId);\n        return decodeAccessToken(accessToken);\n    }\n    /**\n     * Get the user information from the Userinfo Endpoint.\n     *\n     * Note the Userinfo Endpoint will return more claims than the ID Token. See\n     * {@link https://docs.logto.io/docs/recipes/integrate-logto/vanilla-js/#fetch-user-information | Fetch user information}\n     * for more information.\n     *\n     * @returns The user information.\n     * @throws LogtoClientError if the user is not authenticated.\n     */\n    async fetchUserInfo() {\n        const { userinfoEndpoint } = await this.getOidcConfig();\n        const accessToken = await this.getAccessToken();\n        if (!accessToken) {\n            throw new LogtoClientError('fetch_user_info_failed');\n        }\n        return fetchUserInfo(userinfoEndpoint, accessToken, this.adapter.requester);\n    }\n    /**\n     * Start the sign-in flow with the specified redirect URI. The URI must be\n     * registered in the Logto Console.\n     *\n     * The user will be redirected to that URI after the sign-in flow is completed,\n     * and the client will be able to get the authorization code from the URI.\n     * To fetch the tokens from the authorization code, use {@link handleSignInCallback}\n     * after the user is redirected in the callback URI.\n     *\n     * @param redirectUri The redirect URI that the user will be redirected to after the sign-in flow is completed.\n     * @param interactionMode The interaction mode to be used for the authorization request. Note it's not\n     * a part of the OIDC standard, but a Logto-specific extension. Defaults to `signIn`.\n     *\n     * @see {@link https://docs.logto.io/docs/recipes/integrate-logto/vanilla-js/#sign-in | Sign in} for more information.\n     * @see {@link InteractionMode}\n     */\n    async signIn(redirectUri, interactionMode) {\n        const { appId: clientId, prompt, resources, scopes } = this.logtoConfig;\n        const { authorizationEndpoint } = await this.getOidcConfig();\n        const codeVerifier = this.adapter.generateCodeVerifier();\n        const codeChallenge = await this.adapter.generateCodeChallenge(codeVerifier);\n        const state = this.adapter.generateState();\n        const signInUri = generateSignInUri({\n            authorizationEndpoint,\n            clientId,\n            redirectUri,\n            codeChallenge,\n            state,\n            scopes,\n            resources,\n            prompt,\n            interactionMode,\n        });\n        await Promise.all([\n            this.setSignInSession({ redirectUri, codeVerifier, state }),\n            this.setRefreshToken(null),\n            this.setIdToken(null),\n        ]);\n        await this.adapter.navigate(signInUri);\n    }\n    /**\n     * Check if the user is redirected from the sign-in page by checking if the\n     * current URL matches the redirect URI in the sign-in session.\n     *\n     * If there's no sign-in session, it will return `false`.\n     *\n     * @param url The current URL.\n     */\n    async isSignInRedirected(url) {\n        const signInSession = await this.getSignInSession();\n        if (!signInSession) {\n            return false;\n        }\n        const { redirectUri } = signInSession;\n        const { origin, pathname } = new URL(url);\n        return `${origin}${pathname}` === redirectUri;\n    }\n    /**\n     * Start the sign-out flow with the specified redirect URI. The URI must be\n     * registered in the Logto Console.\n     *\n     * It will also revoke all the tokens and clean up the storage.\n     *\n     * The user will be redirected that URI after the sign-out flow is completed.\n     * If the `postLogoutRedirectUri` is not specified, the user will be redirected\n     * to a default page.\n     */\n    async signOut(postLogoutRedirectUri) {\n        const { appId: clientId } = this.logtoConfig;\n        const { endSessionEndpoint, revocationEndpoint } = await this.getOidcConfig();\n        const refreshToken = await this.getRefreshToken();\n        if (refreshToken) {\n            try {\n                await revoke(revocationEndpoint, clientId, refreshToken, this.adapter.requester);\n            }\n            catch {\n                // Do nothing at this point, as we don't want to break the sign-out flow even if the revocation is failed\n            }\n        }\n        const url = generateSignOutUri({\n            endSessionEndpoint,\n            postLogoutRedirectUri,\n            clientId,\n        });\n        this.accessTokenMap.clear();\n        await Promise.all([\n            this.setRefreshToken(null),\n            this.setIdToken(null),\n            this.adapter.storage.removeItem('accessToken'),\n        ]);\n        await this.adapter.navigate(url);\n    }\n    async getSignInSession() {\n        const jsonItem = await this.adapter.storage.getItem('signInSession');\n        if (!jsonItem) {\n            return null;\n        }\n        const item = JSON.parse(jsonItem);\n        if (!isLogtoSignInSessionItem(item)) {\n            throw new LogtoClientError('sign_in_session.invalid');\n        }\n        return item;\n    }\n    async setSignInSession(value) {\n        return this.adapter.setStorageItem(PersistKey.SignInSession, value && JSON.stringify(value));\n    }\n    async setIdToken(value) {\n        return this.adapter.setStorageItem(PersistKey.IdToken, value);\n    }\n    async setRefreshToken(value) {\n        return this.adapter.setStorageItem(PersistKey.RefreshToken, value);\n    }\n    async getAccessTokenByRefreshToken(resource, organizationId) {\n        const currentRefreshToken = await this.getRefreshToken();\n        if (!currentRefreshToken) {\n            throw new LogtoClientError('not_authenticated');\n        }\n        const accessTokenKey = buildAccessTokenKey(resource, organizationId);\n        const { appId: clientId } = this.logtoConfig;\n        const { tokenEndpoint } = await this.getOidcConfig();\n        const requestedAt = Math.round(Date.now() / 1000);\n        const { accessToken, refreshToken, idToken, scope, expiresIn } = await fetchTokenByRefreshToken({\n            clientId,\n            tokenEndpoint,\n            refreshToken: currentRefreshToken,\n            resource,\n            organizationId,\n        }, this.adapter.requester);\n        this.accessTokenMap.set(accessTokenKey, {\n            token: accessToken,\n            scope,\n            /** The `expiresAt` variable provides an approximate estimation of the actual `exp` property\n             * in the token claims. It is utilized by the client to determine if the cached access token\n             * has expired and when a new access token should be requested.\n             */\n            expiresAt: requestedAt + expiresIn,\n        });\n        await this.saveAccessTokenMap();\n        if (refreshToken) {\n            await this.setRefreshToken(refreshToken);\n        }\n        if (idToken) {\n            await this.verifyIdToken(idToken);\n            await this.setIdToken(idToken);\n        }\n        return accessToken;\n    }\n    async verifyIdToken(idToken) {\n        const { appId } = this.logtoConfig;\n        const { issuer } = await this.getOidcConfig();\n        const jwtVerifyGetKey = await this.getJwtVerifyGetKey();\n        await verifyIdToken(idToken, appId, issuer, jwtVerifyGetKey);\n    }\n    async saveAccessTokenMap() {\n        const data = {};\n        for (const [key, accessToken] of this.accessTokenMap.entries()) {\n            // eslint-disable-next-line @silverhand/fp/no-mutation\n            data[key] = accessToken;\n        }\n        await this.adapter.storage.setItem('accessToken', JSON.stringify(data));\n    }\n    async loadAccessTokenMap() {\n        const raw = await this.adapter.storage.getItem('accessToken');\n        if (!raw) {\n            return;\n        }\n        try {\n            const json = JSON.parse(raw);\n            if (!isLogtoAccessTokenMap(json)) {\n                return;\n            }\n            this.accessTokenMap.clear();\n            for (const [key, accessToken] of Object.entries(json)) {\n                this.accessTokenMap.set(key, accessToken);\n            }\n        }\n        catch (error) {\n            console.warn(error);\n        }\n    }\n    async #getOidcConfig() {\n        return this.adapter.getWithCache(CacheKey.OpenidConfig, async () => {\n            return fetchOidcConfig(getDiscoveryEndpoint(this.logtoConfig.endpoint), this.adapter.requester);\n        });\n    }\n    async #getJwtVerifyGetKey() {\n        const { jwksUri } = await this.getOidcConfig();\n        if (!this.adapter.unstable_cache) {\n            return createRemoteJWKSet(new URL(jwksUri));\n        }\n        const cachedJwkSet = new CachedRemoteJwkSet(new URL(jwksUri), this.adapter);\n        return async (...args) => cachedJwkSet.getKey(...args);\n    }\n    async #getAccessToken(resource, organizationId) {\n        if (!(await this.isAuthenticated())) {\n            throw new LogtoClientError('not_authenticated');\n        }\n        const accessTokenKey = buildAccessTokenKey(resource, organizationId);\n        const accessToken = this.accessTokenMap.get(accessTokenKey);\n        if (accessToken && accessToken.expiresAt > Date.now() / 1000) {\n            return accessToken.token;\n        }\n        // Since the access token has expired, delete it from the map.\n        if (accessToken) {\n            this.accessTokenMap.delete(accessTokenKey);\n        }\n        /**\n         * Need to fetch a new access token using refresh token.\n         */\n        return this.getAccessTokenByRefreshToken(resource, organizationId);\n    }\n    async #getOrganizationToken(organizationId) {\n        if (!this.logtoConfig.scopes?.includes(UserScope.Organizations)) {\n            throw new LogtoClientError('missing_scope_organizations');\n        }\n        return this.getAccessToken(undefined, organizationId);\n    }\n    async #handleSignInCallback(callbackUri) {\n        const { requester } = this.adapter;\n        const signInSession = await this.getSignInSession();\n        if (!signInSession) {\n            throw new LogtoClientError('sign_in_session.not_found');\n        }\n        const { redirectUri, state, codeVerifier } = signInSession;\n        const code = verifyAndParseCodeFromCallbackUri(callbackUri, redirectUri, state);\n        // NOTE: Will add scope to accessTokenKey when needed. (Linear issue LOG-1589)\n        const accessTokenKey = buildAccessTokenKey();\n        const { appId: clientId } = this.logtoConfig;\n        const { tokenEndpoint } = await this.getOidcConfig();\n        const requestedAt = Math.round(Date.now() / 1000);\n        const { idToken, refreshToken, accessToken, scope, expiresIn } = await fetchTokenByAuthorizationCode({\n            clientId,\n            tokenEndpoint,\n            redirectUri,\n            codeVerifier,\n            code,\n        }, requester);\n        await this.verifyIdToken(idToken);\n        await this.setRefreshToken(refreshToken ?? null);\n        await this.setIdToken(idToken);\n        this.accessTokenMap.set(accessTokenKey, {\n            token: accessToken,\n            scope,\n            /** The `expiresAt` variable provides an approximate estimation of the actual `exp` property\n             * in the token claims. It is utilized by the client to determine if the cached access token\n             * has expired and when a new access token should be requested.\n             */\n            expiresAt: requestedAt + expiresIn,\n        });\n        await this.saveAccessTokenMap();\n        await this.setSignInSession(null);\n    }\n}\n/* eslint-enable max-lines */\n\nexport { CacheKey, LogtoClientError, PersistKey, LogtoClient as default, isLogtoAccessTokenMap, isLogtoSignInSessionItem, normalizeLogtoConfig };\n", "const keyPrefix = `logto_cache`;\nclass CacheStorage {\n    constructor(appId) {\n        this.appId = appId;\n    }\n    getKey(item) {\n        if (item === undefined) {\n            return `${keyPrefix}:${this.appId}`;\n        }\n        return `${keyPrefix}:${this.appId}:${item}`;\n    }\n    async getItem(key) {\n        return sessionStorage.getItem(this.getKey(key));\n    }\n    async setItem(key, value) {\n        sessionStorage.setItem(this.getKey(key), value);\n    }\n    async removeItem(key) {\n        sessionStorage.removeItem(`${this.getKey(key)}`);\n    }\n}\n\nexport { CacheStorage };\n", "const keyPrefix = `logto`;\nclass BrowserStorage {\n    constructor(appId) {\n        this.appId = appId;\n    }\n    getKey(item) {\n        if (item === undefined) {\n            return `${keyPrefix}:${this.appId}`;\n        }\n        return `${keyPrefix}:${this.appId}:${item}`;\n    }\n    async getItem(key) {\n        if (key === 'signInSession') {\n            // The latter `getItem()` is for backward compatibility. Can be removed when major bump.\n            return sessionStorage.getItem(this.getKey(key)) ?? sessionStorage.getItem(this.getKey());\n        }\n        return localStorage.getItem(this.getKey(key));\n    }\n    async setItem(key, value) {\n        if (key === 'signInSession') {\n            sessionStorage.setItem(this.getKey(key), value);\n            return;\n        }\n        localStorage.setItem(this.getKey(key), value);\n    }\n    async removeItem(key) {\n        if (key === 'signInSession') {\n            sessionStorage.removeItem(this.getKey(key));\n            return;\n        }\n        localStorage.removeItem(this.getKey(key));\n    }\n}\n\nexport { BrowserStorage };\n", "/**\n *  base64.ts\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n *\n * @author Dan Kogai (https://github.com/dankogai)\n */\nconst version = '3.7.6';\n/**\n * @deprecated use lowercase `version`.\n */\nconst VERSION = version;\nconst _hasatob = typeof atob === 'function';\nconst _hasbtoa = typeof btoa === 'function';\nconst _hasBuffer = typeof Buffer === 'function';\nconst _TD = typeof TextDecoder === 'function' ? new TextDecoder() : undefined;\nconst _TE = typeof TextEncoder === 'function' ? new TextEncoder() : undefined;\nconst b64ch = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nconst b64chs = Array.prototype.slice.call(b64ch);\nconst b64tab = ((a) => {\n    let tab = {};\n    a.forEach((c, i) => tab[c] = i);\n    return tab;\n})(b64chs);\nconst b64re = /^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/;\nconst _fromCC = String.fromCharCode.bind(String);\nconst _U8Afrom = typeof Uint8Array.from === 'function'\n    ? Uint8Array.from.bind(Uint8Array)\n    : (it) => new Uint8Array(Array.prototype.slice.call(it, 0));\nconst _mkUriSafe = (src) => src\n    .replace(/=/g, '').replace(/[+\\/]/g, (m0) => m0 == '+' ? '-' : '_');\nconst _tidyB64 = (s) => s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\n/**\n * polyfill version of `btoa`\n */\nconst btoaPolyfill = (bin) => {\n    // console.log('polyfilled');\n    let u32, c0, c1, c2, asc = '';\n    const pad = bin.length % 3;\n    for (let i = 0; i < bin.length;) {\n        if ((c0 = bin.charCodeAt(i++)) > 255 ||\n            (c1 = bin.charCodeAt(i++)) > 255 ||\n            (c2 = bin.charCodeAt(i++)) > 255)\n            throw new TypeError('invalid character found');\n        u32 = (c0 << 16) | (c1 << 8) | c2;\n        asc += b64chs[u32 >> 18 & 63]\n            + b64chs[u32 >> 12 & 63]\n            + b64chs[u32 >> 6 & 63]\n            + b64chs[u32 & 63];\n    }\n    return pad ? asc.slice(0, pad - 3) + \"===\".substring(pad) : asc;\n};\n/**\n * does what `window.btoa` of web browsers do.\n * @param {String} bin binary string\n * @returns {string} Base64-encoded string\n */\nconst _btoa = _hasbtoa ? (bin) => btoa(bin)\n    : _hasBuffer ? (bin) => Buffer.from(bin, 'binary').toString('base64')\n        : btoaPolyfill;\nconst _fromUint8Array = _hasBuffer\n    ? (u8a) => Buffer.from(u8a).toString('base64')\n    : (u8a) => {\n        // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326\n        const maxargs = 0x1000;\n        let strs = [];\n        for (let i = 0, l = u8a.length; i < l; i += maxargs) {\n            strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));\n        }\n        return _btoa(strs.join(''));\n    };\n/**\n * converts a Uint8Array to a Base64 string.\n * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 5\n * @returns {string} Base64 string\n */\nconst fromUint8Array = (u8a, urlsafe = false) => urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const utob = (src: string) => unescape(encodeURIComponent(src));\n// reverting good old fationed regexp\nconst cb_utob = (c) => {\n    if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c\n            : cc < 0x800 ? (_fromCC(0xc0 | (cc >>> 6))\n                + _fromCC(0x80 | (cc & 0x3f)))\n                : (_fromCC(0xe0 | ((cc >>> 12) & 0x0f))\n                    + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n                    + _fromCC(0x80 | (cc & 0x3f)));\n    }\n    else {\n        var cc = 0x10000\n            + (c.charCodeAt(0) - 0xD800) * 0x400\n            + (c.charCodeAt(1) - 0xDC00);\n        return (_fromCC(0xf0 | ((cc >>> 18) & 0x07))\n            + _fromCC(0x80 | ((cc >>> 12) & 0x3f))\n            + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n            + _fromCC(0x80 | (cc & 0x3f)));\n    }\n};\nconst re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-8 string\n * @returns {string} UTF-16 string\n */\nconst utob = (u) => u.replace(re_utob, cb_utob);\n//\nconst _encode = _hasBuffer\n    ? (s) => Buffer.from(s, 'utf8').toString('base64')\n    : _TE\n        ? (s) => _fromUint8Array(_TE.encode(s))\n        : (s) => _btoa(utob(s));\n/**\n * converts a UTF-8-encoded string to a Base64 string.\n * @param {boolean} [urlsafe] if `true` make the result URL-safe\n * @returns {string} Base64 string\n */\nconst encode = (src, urlsafe = false) => urlsafe\n    ? _mkUriSafe(_encode(src))\n    : _encode(src);\n/**\n * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 5.\n * @returns {string} Base64 string\n */\nconst encodeURI = (src) => encode(src, true);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const btou = (src: string) => decodeURIComponent(escape(src));\n// reverting good old fationed regexp\nconst re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\nconst cb_btou = (cccc) => {\n    switch (cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                | ((0x3f & cccc.charCodeAt(1)) << 12)\n                | ((0x3f & cccc.charCodeAt(2)) << 6)\n                | (0x3f & cccc.charCodeAt(3)), offset = cp - 0x10000;\n            return (_fromCC((offset >>> 10) + 0xD800)\n                + _fromCC((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return _fromCC(((0x0f & cccc.charCodeAt(0)) << 12)\n                | ((0x3f & cccc.charCodeAt(1)) << 6)\n                | (0x3f & cccc.charCodeAt(2)));\n        default:\n            return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6)\n                | (0x3f & cccc.charCodeAt(1)));\n    }\n};\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-16 string\n * @returns {string} UTF-8 string\n */\nconst btou = (b) => b.replace(re_btou, cb_btou);\n/**\n * polyfill version of `atob`\n */\nconst atobPolyfill = (asc) => {\n    // console.log('polyfilled');\n    asc = asc.replace(/\\s+/g, '');\n    if (!b64re.test(asc))\n        throw new TypeError('malformed base64.');\n    asc += '=='.slice(2 - (asc.length & 3));\n    let u24, bin = '', r1, r2;\n    for (let i = 0; i < asc.length;) {\n        u24 = b64tab[asc.charAt(i++)] << 18\n            | b64tab[asc.charAt(i++)] << 12\n            | (r1 = b64tab[asc.charAt(i++)]) << 6\n            | (r2 = b64tab[asc.charAt(i++)]);\n        bin += r1 === 64 ? _fromCC(u24 >> 16 & 255)\n            : r2 === 64 ? _fromCC(u24 >> 16 & 255, u24 >> 8 & 255)\n                : _fromCC(u24 >> 16 & 255, u24 >> 8 & 255, u24 & 255);\n    }\n    return bin;\n};\n/**\n * does what `window.atob` of web browsers do.\n * @param {String} asc Base64-encoded string\n * @returns {string} binary string\n */\nconst _atob = _hasatob ? (asc) => atob(_tidyB64(asc))\n    : _hasBuffer ? (asc) => Buffer.from(asc, 'base64').toString('binary')\n        : atobPolyfill;\n//\nconst _toUint8Array = _hasBuffer\n    ? (a) => _U8Afrom(Buffer.from(a, 'base64'))\n    : (a) => _U8Afrom(_atob(a).split('').map(c => c.charCodeAt(0)));\n/**\n * converts a Base64 string to a Uint8Array.\n */\nconst toUint8Array = (a) => _toUint8Array(_unURI(a));\n//\nconst _decode = _hasBuffer\n    ? (a) => Buffer.from(a, 'base64').toString('utf8')\n    : _TD\n        ? (a) => _TD.decode(_toUint8Array(a))\n        : (a) => btou(_atob(a));\nconst _unURI = (a) => _tidyB64(a.replace(/[-_]/g, (m0) => m0 == '-' ? '+' : '/'));\n/**\n * converts a Base64 string to a UTF-8 string.\n * @param {String} src Base64 string.  Both normal and URL-safe are supported\n * @returns {string} UTF-8 string\n */\nconst decode = (src) => _decode(_unURI(src));\n/**\n * check if a value is a valid Base64 string\n * @param {String} src a value to check\n  */\nconst isValid = (src) => {\n    if (typeof src !== 'string')\n        return false;\n    const s = src.replace(/\\s+/g, '').replace(/={0,2}$/, '');\n    return !/[^\\s0-9a-zA-Z\\+/]/.test(s) || !/[^\\s0-9a-zA-Z\\-_]/.test(s);\n};\n//\nconst _noEnum = (v) => {\n    return {\n        value: v, enumerable: false, writable: true, configurable: true\n    };\n};\n/**\n * extend String.prototype with relevant methods\n */\nconst extendString = function () {\n    const _add = (name, body) => Object.defineProperty(String.prototype, name, _noEnum(body));\n    _add('fromBase64', function () { return decode(this); });\n    _add('toBase64', function (urlsafe) { return encode(this, urlsafe); });\n    _add('toBase64URI', function () { return encode(this, true); });\n    _add('toBase64URL', function () { return encode(this, true); });\n    _add('toUint8Array', function () { return toUint8Array(this); });\n};\n/**\n * extend Uint8Array.prototype with relevant methods\n */\nconst extendUint8Array = function () {\n    const _add = (name, body) => Object.defineProperty(Uint8Array.prototype, name, _noEnum(body));\n    _add('toBase64', function (urlsafe) { return fromUint8Array(this, urlsafe); });\n    _add('toBase64URI', function () { return fromUint8Array(this, true); });\n    _add('toBase64URL', function () { return fromUint8Array(this, true); });\n};\n/**\n * extend Builtin prototypes with relevant methods\n */\nconst extendBuiltins = () => {\n    extendString();\n    extendUint8Array();\n};\nconst gBase64 = {\n    version: version,\n    VERSION: VERSION,\n    atob: _atob,\n    atobPolyfill: atobPolyfill,\n    btoa: _btoa,\n    btoaPolyfill: btoaPolyfill,\n    fromBase64: decode,\n    toBase64: encode,\n    encode: encode,\n    encodeURI: encodeURI,\n    encodeURL: encodeURI,\n    utob: utob,\n    btou: btou,\n    decode: decode,\n    isValid: isValid,\n    fromUint8Array: fromUint8Array,\n    toUint8Array: toUint8Array,\n    extendString: extendString,\n    extendUint8Array: extendUint8Array,\n    extendBuiltins: extendBuiltins\n};\n// makecjs:CUT //\nexport { version };\nexport { VERSION };\nexport { _atob as atob };\nexport { atobPolyfill };\nexport { _btoa as btoa };\nexport { btoaPolyfill };\nexport { decode as fromBase64 };\nexport { encode as toBase64 };\nexport { utob };\nexport { encode };\nexport { encodeURI };\nexport { encodeURI as encodeURL };\nexport { btou };\nexport { decode };\nexport { isValid };\nexport { fromUint8Array };\nexport { toUint8Array };\nexport { extendString };\nexport { extendUint8Array };\nexport { extendBuiltins };\n// and finally,\nexport { gBase64 as Base64 };\n", "import { LogtoError } from '@logto/client';\nimport { fromUint8Array } from 'js-base64';\n\n/** @link [Proof Key for Code Exchange by OAuth Public Clients](https://datatracker.ietf.org/doc/html/rfc7636) */\n/**\n * @param length The length of the raw random data.\n */\nconst generateRandomString = (length = 64) => fromUint8Array(crypto.getRandomValues(new Uint8Array(length)), true);\n/**\n * Generates random string for state and encodes them in url safe base64\n */\nconst generateState = () => generateRandomString();\n/**\n * Generates code verifier\n *\n * @link [Client Creates a Code Verifier](https://datatracker.ietf.org/doc/html/rfc7636#section-4.1)\n */\nconst generateCodeVerifier = () => generateRandomString();\n/**\n * Calculates the S256 PKCE code challenge for an arbitrary code verifier and encodes it in url safe base64\n *\n * @param {String} codeVerifier Code verifier to calculate the S256 code challenge for\n * @link [Client Creates the Code Challenge](https://datatracker.ietf.org/doc/html/rfc7636#section-4.2)\n */\nconst generateCodeChallenge = async (codeVerifier) => {\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (crypto.subtle === undefined) {\n        /**\n         * `crypto.subtle` is available only in secure contexts (HTTPS) in some or all supporting browsers,\n         * https://developer.mozilla.org/en-US/docs/Web/API/Crypto/subtle\n         * https://www.chromium.org/blink/webcrypto/#accessing-it\n         */\n        throw new LogtoError('crypto_subtle_unavailable');\n    }\n    const encodedCodeVerifier = new TextEncoder().encode(codeVerifier);\n    const codeChallenge = new Uint8Array(await crypto.subtle.digest('SHA-256', encodedCodeVerifier));\n    return fromUint8Array(codeChallenge, true);\n};\n\nexport { generateCodeChallenge, generateCodeVerifier, generateState };\n", "import BaseClient, { createRequester } from '@logto/client';\nexport { default as BaseClient, LogtoClientError, LogtoError, LogtoRequestError, OidcError, PersistKey, Prompt, ReservedResource, ReservedScope, UserScope, buildOrganizationUrn, createRequester, getOrganizationIdFromUrn, organizationUrnPrefix } from '@logto/client';\nimport { conditional } from '@silverhand/essentials';\nimport { CacheStorage } from './cache.js';\nimport { BrowserStorage } from './storage.js';\nimport { generateCodeChallenge, generateCodeVerifier, generateState } from './utils/generators.js';\n\nconst navigate = (url) => {\n    window.location.assign(url);\n};\nclass LogtoClient extends BaseClient {\n    /**\n     * @param config The configuration object for the client.\n     * @param [unstable_enableCache=false] Whether to enable cache for well-known data.\n     * Use sessionStorage by default.\n     */\n    constructor(config, unstable_enableCache = false) {\n        const requester = createRequester(fetch);\n        super(config, {\n            requester,\n            navigate,\n            storage: new BrowserStorage(config.appId),\n            unstable_cache: conditional(unstable_enableCache && new CacheStorage(config.appId)),\n            generateCodeChallenge,\n            generateCodeVerifier,\n            generateState,\n        });\n    }\n}\n\nexport { LogtoClient as default, generateCodeChallenge, generateCodeVerifier, generateState };\n", "const logtoInjectionKey = '@logto/vue';\nconst contextInjectionKey = '@logto/vue:context';\n\nexport { contextInjectionKey, logtoInjectionKey };\n", "import { toRefs, reactive, computed } from 'vue';\n\nconst createContext = (client) => {\n    const context = toRefs(reactive({\n        logtoClient: client,\n        isAuthenticated: false,\n        loadingCount: 1,\n        error: undefined,\n    }));\n    const { isAuthenticated, loadingCount, error } = context;\n    const isLoading = computed(() => loadingCount.value > 0);\n    /* eslint-disable @silverhand/fp/no-mutation */\n    const setError = (_error, fallbackErrorMessage) => {\n        if (_error instanceof Error) {\n            error.value = _error;\n        }\n        else if (fallbackErrorMessage) {\n            error.value = new Error(fallbackErrorMessage);\n        }\n        console.error(error);\n    };\n    const setLoading = (isLoading) => {\n        if (isLoading) {\n            loadingCount.value += 1;\n        }\n        else {\n            loadingCount.value = Math.max(0, loadingCount.value - 1);\n        }\n    };\n    const setIsAuthenticated = (_isAuthenticated) => {\n        isAuthenticated.value = _isAuthenticated;\n    };\n    /* eslint-enable @silverhand/fp/no-mutation */\n    (async () => {\n        const isAuthenticated = await client.isAuthenticated();\n        setIsAuthenticated(isAuthenticated);\n        setLoading(false);\n    })();\n    return { ...context, isLoading, setError, setLoading, setIsAuthenticated };\n};\nconst throwContextError = () => {\n    throw new Error('Must install Logto plugin first.');\n};\n\nexport { createContext, throwContextError };\n", "import { throwContextError } from './context.js';\n\nconst createPluginMethods = (context) => {\n    const { logtoClient, setLoading, setError, setIsAuthenticated } = context;\n    const client = logtoClient.value ?? throwContextError();\n    const proxy = (run, resetLoadingState = true) => {\n        return async (...args) => {\n            try {\n                setLoading(true);\n                return await run(...args);\n            }\n            catch (error) {\n                setError(error, `Unexpected error occurred while calling ${run.name}.`);\n            }\n            finally {\n                if (resetLoadingState) {\n                    setLoading(false);\n                }\n            }\n        };\n    };\n    const methods = {\n        getRefreshToken: proxy(client.getRefreshToken.bind(client)),\n        getAccessToken: proxy(client.getAccessToken.bind(client)),\n        getAccessTokenClaims: proxy(client.getAccessTokenClaims.bind(client)),\n        getOrganizationToken: proxy(client.getOrganizationToken.bind(client)),\n        getOrganizationTokenClaims: proxy(client.getOrganizationTokenClaims.bind(client)),\n        getIdToken: proxy(client.getIdToken.bind(client)),\n        getIdTokenClaims: proxy(client.getIdTokenClaims.bind(client)),\n        signIn: proxy(client.signIn.bind(client), false),\n        // We deliberately do NOT set isAuthenticated to false in the function below, because the app state\n        // may change immediately even before navigating to the oidc end session endpoint, which might cause\n        // rendering problems.\n        // Moreover, since the location will be redirected, the isAuthenticated state will not matter any more.\n        signOut: proxy(client.signOut.bind(client)),\n        fetchUserInfo: proxy(client.fetchUserInfo.bind(client)),\n    };\n    const handleSignInCallback = async (callbackUri, callbackFunction) => {\n        if (!logtoClient.value) {\n            return throwContextError();\n        }\n        try {\n            setLoading(true);\n            await logtoClient.value.handleSignInCallback(callbackUri);\n            setIsAuthenticated(true);\n            callbackFunction?.();\n        }\n        catch (error) {\n            setError(error, 'Unexpected error occurred while handling sign in callback.');\n        }\n        finally {\n            setLoading(false);\n        }\n    };\n    return {\n        ...methods,\n        handleSignInCallback,\n    };\n};\n\nexport { createPluginMethods };\n", "import LogtoClient from '@logto/browser';\nexport { LogtoClientError, LogtoError, LogtoRequestError, OidcError, PersistKey, Prompt, ReservedScope, UserScope, buildOrganizationUrn, getOrganizationIdFromUrn, organizationUrnPrefix } from '@logto/browser';\nimport { readonly, inject, watchEffect } from 'vue';\nimport { contextInjectionKey, logtoInjectionKey } from './consts.js';\nimport { createContext, throwContextError } from './context.js';\nimport { createPluginMethods } from './plugin.js';\n\n/**\n * Creates the Logto Vue plugin\n *\n * ```ts\n * import { createApp } from 'vue';\n * import { createLogto } from '@logto/vue';\n *\n * const app = createApp(App);\n * const app.use(createLogto, {\n *   appId: '<your-app-id>',\n *   endpoint: '<your-oidc-endpoint-domain>',\n * });\n *\n * app.mount('#app');\n * ```\n *\n * Use this in your Vue root component to register the plugin\n */\nconst createLogto = {\n    install(app, config) {\n        const client = new LogtoClient(config);\n        const context = createContext(client);\n        const pluginMethods = createPluginMethods(context);\n        const { isAuthenticated, isLoading, error } = context;\n        app.provide(contextInjectionKey, context);\n        app.provide(logtoInjectionKey, {\n            isAuthenticated: readonly(isAuthenticated),\n            isLoading: readonly(isLoading),\n            error: readonly(error),\n            ...pluginMethods,\n        });\n    },\n};\n/**\n * A Vue composable method that provides the Logto reactive refs and auth methods.\n *\n * ```ts\n * import { useLogto } from '@logto/vue';\n *\n * export default {\n *  setup() {\n *    const { isAuthenticated, signIn } = useLogto();\n *\n *    return {\n *      isAuthenticated,\n *      onClickSignIn: () => {\n *        signIn('<your-redirect-uri>');\n *      },\n *    }\n *  }\n * }\n * ```\n *\n * Use this composable in the setup script of your Vue component to make sure the injection works\n */\nconst useLogto = () => {\n    const logto = inject(logtoInjectionKey);\n    if (!logto) {\n        return throwContextError();\n    }\n    return logto;\n};\n/**\n * A Vue composable method that watches browser navigation and automatically handles the sign-in callback\n *\n * ```ts\n * import { useLogto } from '@logto/vue';\n * import { useHandleSignInCallback } from '@logto/vue';\n *\n * export default {\n *   setup() {\n *     useHandleSignInCallback();\n *   }\n * }\n * ```\n *\n * Use this in the setup script of your Callback page to make sure the injection works\n */\nconst useHandleSignInCallback = (callback) => {\n    const context = inject(contextInjectionKey);\n    if (!context) {\n        return throwContextError();\n    }\n    const { isAuthenticated, isLoading, logtoClient, error } = context;\n    const { handleSignInCallback } = createPluginMethods(context);\n    watchEffect(async () => {\n        if (!logtoClient.value) {\n            return;\n        }\n        const currentPageUrl = window.location.href;\n        const isAuthenticated = await logtoClient.value.isAuthenticated();\n        const isRedirected = await logtoClient.value.isSignInRedirected(currentPageUrl);\n        if (!isAuthenticated && isRedirected) {\n            void handleSignInCallback(currentPageUrl, callback);\n        }\n    });\n    return {\n        isLoading: readonly(isLoading),\n        isAuthenticated: readonly(isAuthenticated),\n        error: readonly(error),\n    };\n};\n\nexport { createLogto, useHandleSignInCallback, useLogto };\n"],
  "mappings": "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",
  "names": ["isObject", "key", "value", "has", "isObject", "ReservedScope", "ReservedResource", "UserScope", "TokenGrantType", "QueryKey", "Prompt", "camelcaseKeys", "import_camelcase_keys", "camelcaseKeys", "message", "_a", "types", "isObject", "isObject", "isObject", "isObject", "_a", "isObject", "jwk", "base64url_exports", "decode", "encode", "encode", "decode", "message", "idTokenClaims", "PersistKey", "CacheKey", "_a", "once", "message", "once", "_a", "keyPrefix", "LogtoClient", "isLoading", "isAuthenticated", "LogtoClient", "isAuthenticated"]
}
